/**
MinnPost Givalike Pages - 0.1.0
http://www.minnpost.com
Copyright (c) 2015 Jonathan Stegall
License: MIT
*/
!function(a,b,c,d){function e(b,c){this.options=a.extend(!0,{},f,c),this.input=b,this.$input=a(b),this._defaults=f,this._name="geocomplete",this.init()}var f={bounds:!0,country:null,map:!1,details:!1,detailsAttribute:"name",autoselect:!0,location:!1,mapOptions:{zoom:14,scrollwheel:!1,mapTypeId:"roadmap"},markerOptions:{draggable:!1},maxZoom:16,types:["geocode"],blur:!1,geocodeAfterResult:!1,restoreValueAfterBlur:!1},g="street_address route intersection political country administrative_area_level_1 administrative_area_level_2 administrative_area_level_3 colloquial_area locality sublocality neighborhood premise subpremise postal_code natural_feature airport park point_of_interest post_box street_number floor room lat lng viewport location formatted_address location_type bounds".split(" "),h="id place_id url website vicinity reference name rating international_phone_number icon formatted_phone_number".split(" ");a.extend(e.prototype,{init:function(){this.initMap(),this.initMarker(),this.initGeocoder(),this.initDetails(),this.initLocation()},initMap:function(){if(this.options.map){if("function"==typeof this.options.map.setCenter)return void(this.map=this.options.map);this.map=new google.maps.Map(a(this.options.map)[0],this.options.mapOptions),google.maps.event.addListener(this.map,"click",a.proxy(this.mapClicked,this)),google.maps.event.addListener(this.map,"zoom_changed",a.proxy(this.mapZoomed,this))}},initMarker:function(){if(this.map){var b=a.extend(this.options.markerOptions,{map:this.map});b.disabled||(this.marker=new google.maps.Marker(b),google.maps.event.addListener(this.marker,"dragend",a.proxy(this.markerDragged,this)))}},initGeocoder:function(){var b={types:this.options.types,bounds:this.options.bounds===!0?null:this.options.bounds,componentRestrictions:this.options.componentRestrictions};this.options.country&&(b.componentRestrictions={country:this.options.country}),this.autocomplete=new google.maps.places.Autocomplete(this.input,b),this.geocoder=new google.maps.Geocoder,this.map&&this.options.bounds===!0&&this.autocomplete.bindTo("bounds",this.map),google.maps.event.addListener(this.autocomplete,"place_changed",a.proxy(this.placeChanged,this)),this.$input.on("keypress."+this._name,function(a){return 13===a.keyCode?!1:void 0}),this.options.geocodeAfterResult===!0&&this.$input.bind("keypress."+this._name,a.proxy(function(){9!=event.keyCode&&this.selected===!0&&(this.selected=!1)},this)),this.$input.bind("geocode."+this._name,a.proxy(function(){this.find()},this)),this.$input.bind("geocode:result."+this._name,a.proxy(function(){this.lastInputVal=this.$input.val()},this)),this.options.blur===!0&&this.$input.on("blur."+this._name,a.proxy(function(){(this.options.geocodeAfterResult!==!0||this.selected!==!0)&&(this.options.restoreValueAfterBlur===!0&&this.selected===!0?setTimeout(a.proxy(this.restoreLastValue,this),0):this.find())},this))},initDetails:function(){function b(a){e[a]=c.find("["+d+"="+a+"]")}if(this.options.details){var c=a(this.options.details),d=this.options.detailsAttribute,e={};a.each(g,function(a,c){b(c),b(c+"_short")}),a.each(h,function(a,c){b(c)}),this.$details=c,this.details=e}},initLocation:function(){var a,b=this.options.location;if(b){if("string"==typeof b)return void this.find(b);b instanceof Array&&(a=new google.maps.LatLng(b[0],b[1])),b instanceof google.maps.LatLng&&(a=b),a&&(this.map&&this.map.setCenter(a),this.marker&&this.marker.setPosition(a))}},destroy:function(){this.map&&(google.maps.event.clearInstanceListeners(this.map),google.maps.event.clearInstanceListeners(this.marker)),this.autocomplete.unbindAll(),google.maps.event.clearInstanceListeners(this.autocomplete),google.maps.event.clearInstanceListeners(this.input),this.$input.removeData(),this.$input.off(this._name),this.$input.unbind("."+this._name)},find:function(a){this.geocode({address:a||this.$input.val()})},geocode:function(b){this.options.bounds&&!b.bounds&&(this.options.bounds===!0?b.bounds=this.map&&this.map.getBounds():b.bounds=this.options.bounds),this.options.country&&(b.region=this.options.country),this.geocoder.geocode(b,a.proxy(this.handleGeocode,this))},selectFirstResult:function(){var b="";a(".pac-item-selected")[0]&&(b="-selected");var c=a(".pac-container:last .pac-item"+b+":first span:nth-child(2)").text(),d=a(".pac-container:last .pac-item"+b+":first span:nth-child(3)").text(),e=c;return d&&(e+=" - "+d),this.$input.val(e),e},restoreLastValue:function(){this.lastInputVal&&this.$input.val(this.lastInputVal)},handleGeocode:function(a,b){if(b===google.maps.GeocoderStatus.OK){var c=a[0];this.$input.val(c.formatted_address),this.update(c),a.length>1&&this.trigger("geocode:multiple",a)}else this.trigger("geocode:error",b)},trigger:function(a,b){this.$input.trigger(a,[b])},center:function(a){a.viewport?(this.map.fitBounds(a.viewport),this.map.getZoom()>this.options.maxZoom&&this.map.setZoom(this.options.maxZoom)):(this.map.setZoom(this.options.maxZoom),this.map.setCenter(a.location)),this.marker&&(this.marker.setPosition(a.location),this.marker.setAnimation(this.options.markerOptions.animation))},update:function(a){this.map&&this.center(a.geometry),this.$details&&this.fillDetails(a),this.trigger("geocode:result",a)},fillDetails:function(b){var c={},d=b.geometry,e=d.viewport,f=d.bounds;a.each(b.address_components,function(b,d){d.types[0];a.each(d.types,function(a,b){c[b]=d.long_name,c[b+"_short"]=d.short_name})}),a.each(h,function(a,d){c[d]=b[d]}),a.extend(c,{formatted_address:b.formatted_address,location_type:d.location_type||"PLACES",viewport:e,bounds:f,location:d.location,lat:d.location.lat(),lng:d.location.lng()}),a.each(this.details,a.proxy(function(a,b){var d=c[a];this.setDetail(b,d)},this)),this.data=c},setDetail:function(a,b){b===d?b="":"function"==typeof b.toUrlValue&&(b=b.toUrlValue()),a.is(":input")?a.val(b):a.text(b)},markerDragged:function(a){this.trigger("geocode:dragged",a.latLng)},mapClicked:function(a){this.trigger("geocode:click",a.latLng)},mapZoomed:function(a){this.trigger("geocode:zoom",this.map.getZoom())},resetMarker:function(){this.marker.setPosition(this.data.location),this.setDetail(this.details.lat,this.data.location.lat()),this.setDetail(this.details.lng,this.data.location.lng())},placeChanged:function(){var a=this.autocomplete.getPlace();if(this.selected=!0,a.geometry)this.update(a);else if(this.options.autoselect){var b=this.selectFirstResult();this.find(b)}}}),a.fn.geocomplete=function(b){var c="plugin_geocomplete";if("string"==typeof b){var d=a(this).data(c)||a(this).geocomplete().data(c),f=d[b];return"function"==typeof f?(f.apply(d,Array.prototype.slice.call(arguments,1)),a(this)):(2==arguments.length&&(f=arguments[1]),f)}return this.each(function(){var d=a.data(this,c);d||(d=new e(this,b),a.data(this,c,d))})}}(jQuery,window,document),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=[].slice,w=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};$.payment={},$.payment.fn={},$.fn.payment=function(){var a,b;return b=arguments[0],a=2<=arguments.length?v.call(arguments,1):[],$.payment.fn[b].apply(this,a)},d=/(\d{1,4})/g,$.payment.cards=c=[{type:"visaelectron",pattern:/^4(026|17500|405|508|844|91[37])/,format:d,length:[16],cvcLength:[3],luhn:!0},{type:"maestro",pattern:/^(5(018|0[23]|[68])|6(39|7))/,format:d,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"forbrugsforeningen",pattern:/^600/,format:d,length:[16],cvcLength:[3],luhn:!0},{type:"dankort",pattern:/^5019/,format:d,length:[16],cvcLength:[3],luhn:!0},{type:"visa",pattern:/^4/,format:d,length:[13,16],cvcLength:[3],luhn:!0},{type:"mastercard",pattern:/^5[0-5]/,format:d,length:[16],cvcLength:[3],luhn:!0},{type:"amex",pattern:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[3,4],luhn:!0},{type:"dinersclub",pattern:/^3[0689]/,format:/(\d{1,4})(\d{1,6})?(\d{1,4})?/,length:[14],cvcLength:[3],luhn:!0},{type:"discover",pattern:/^6([045]|22)/,format:d,length:[16],cvcLength:[3],luhn:!0},{type:"unionpay",pattern:/^(62|88)/,format:d,length:[16,17,18,19],cvcLength:[3],luhn:!1},{type:"jcb",pattern:/^35/,format:d,length:[16],cvcLength:[3],luhn:!0}],a=function(a){var b,d,e;for(a=(a+"").replace(/\D/g,""),d=0,e=c.length;e>d;d++)if(b=c[d],b.pattern.test(a))return b},b=function(a){var b,d,e;for(d=0,e=c.length;e>d;d++)if(b=c[d],b.type===a)return b},l=function(a){var b,c,d,e,f,g;for(d=!0,e=0,c=(a+"").split("").reverse(),f=0,g=c.length;g>f;f++)b=c[f],b=parseInt(b,10),(d=!d)&&(b*=2),b>9&&(b-=9),e+=b;return e%10===0},k=function(a){var b;return null!=a.prop("selectionStart")&&a.prop("selectionStart")!==a.prop("selectionEnd")?!0:null!=("undefined"!=typeof document&&null!==document&&null!=(b=document.selection)?b.createRange:void 0)&&document.selection.createRange().text?!0:!1},p=function(a){return setTimeout(function(){var b,c;return b=$(a.currentTarget),c=b.val(),c=c.replace(/\D/g,""),b.val(c)})},n=function(a){return setTimeout(function(){var b,c;return b=$(a.currentTarget),c=b.val(),c=$.payment.formatCardNumber(c),b.val(c)})},g=function(b){var c,d,e,f,g,h,i;return e=String.fromCharCode(b.which),!/^\d+$/.test(e)||(c=$(b.currentTarget),i=c.val(),d=a(i+e),f=(i.replace(/\D/g,"")+e).length,h=16,d&&(h=d.length[d.length.length-1]),f>=h||null!=c.prop("selectionStart")&&c.prop("selectionStart")!==i.length)?void 0:(g=d&&"amex"===d.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/,g.test(i)?(b.preventDefault(),setTimeout(function(){return c.val(i+" "+e)})):g.test(i+e)?(b.preventDefault(),setTimeout(function(){return c.val(i+e+" ")})):void 0)},e=function(a){var b,c;return b=$(a.currentTarget),c=b.val(),8!==a.which||null!=b.prop("selectionStart")&&b.prop("selectionStart")!==c.length?void 0:/\d\s$/.test(c)?(a.preventDefault(),setTimeout(function(){return b.val(c.replace(/\d\s$/,""))})):/\s\d?$/.test(c)?(a.preventDefault(),setTimeout(function(){return b.val(c.replace(/\d$/,""))})):void 0},o=function(a){return setTimeout(function(){var b,c;return b=$(a.currentTarget),c=b.val(),c=$.payment.formatExpiry(c),b.val(c)})},h=function(a){var b,c,d;return c=String.fromCharCode(a.which),/^\d+$/.test(c)?(b=$(a.currentTarget),d=b.val()+c,/^\d$/.test(d)&&"0"!==d&&"1"!==d?(a.preventDefault(),setTimeout(function(){return b.val("0"+d+" / ")})):/^\d\d$/.test(d)?(a.preventDefault(),setTimeout(function(){return b.val(""+d+" / ")})):void 0):void 0},i=function(a){var b,c,d;return c=String.fromCharCode(a.which),/^\d+$/.test(c)?(b=$(a.currentTarget),d=b.val(),/^\d\d$/.test(d)?b.val(""+d+" / "):void 0):void 0},j=function(a){var b,c,d;return d=String.fromCharCode(a.which),"/"===d||" "===d?(b=$(a.currentTarget),c=b.val(),/^\d$/.test(c)&&"0"!==c?b.val("0"+c+" / "):void 0):void 0},f=function(a){var b,c;return b=$(a.currentTarget),c=b.val(),8!==a.which||null!=b.prop("selectionStart")&&b.prop("selectionStart")!==c.length?void 0:/\d\s\/\s$/.test(c)?(a.preventDefault(),setTimeout(function(){return b.val(c.replace(/\d\s\/\s$/,""))})):void 0},m=function(a){return setTimeout(function(){var b,c;return b=$(a.currentTarget),c=b.val(),c=c.replace(/\D/g,"").slice(0,4),b.val(c)})},t=function(a){var b;return a.metaKey||a.ctrlKey?!0:32===a.which?!1:0===a.which?!0:a.which<33?!0:(b=String.fromCharCode(a.which),!!/[\d\s]/.test(b))},r=function(b){var c,d,e,f;return c=$(b.currentTarget),e=String.fromCharCode(b.which),/^\d+$/.test(e)&&!k(c)?(f=(c.val()+e).replace(/\D/g,""),d=a(f),d?f.length<=d.length[d.length.length-1]:f.length<=16):void 0},s=function(a){var b,c,d;return b=$(a.currentTarget),c=String.fromCharCode(a.which),/^\d+$/.test(c)&&!k(b)?(d=b.val()+c,d=d.replace(/\D/g,""),d.length>6?!1:void 0):void 0},q=function(a){var b,c,d;return b=$(a.currentTarget),c=String.fromCharCode(a.which),/^\d+$/.test(c)&&!k(b)?(d=b.val()+c,d.length<=4):void 0},u=function(a){var b,d,e,f,g;return b=$(a.currentTarget),g=b.val(),f=$.payment.cardType(g)||"unknown",b.hasClass(f)?void 0:(d=function(){var a,b,d;for(d=[],a=0,b=c.length;b>a;a++)e=c[a],d.push(e.type);return d}(),b.removeClass("unknown"),b.removeClass(d.join(" ")),b.addClass(f),b.toggleClass("identified","unknown"!==f),b.trigger("payment.cardType",f))},$.payment.fn.formatCardCVC=function(){return this.on("keypress",t),this.on("keypress",q),this.on("paste",m),this.on("change",m),this.on("input",m),this},$.payment.fn.formatCardExpiry=function(){return this.on("keypress",t),this.on("keypress",s),this.on("keypress",h),this.on("keypress",j),this.on("keypress",i),this.on("keydown",f),this.on("change",o),this.on("input",o),this},$.payment.fn.formatCardNumber=function(){return this.on("keypress",t),this.on("keypress",r),this.on("keypress",g),this.on("keydown",e),this.on("keyup",u),this.on("paste",n),this.on("change",n),this.on("input",n),this.on("input",u),this},$.payment.fn.restrictNumeric=function(){return this.on("keypress",t),this.on("paste",p),this.on("change",p),this.on("input",p),this},$.payment.fn.cardExpiryVal=function(){return $.payment.cardExpiryVal($(this).val())},$.payment.cardExpiryVal=function(a){var b,c,d,e;return a=a.replace(/\s/g,""),e=a.split("/",2),b=e[0],d=e[1],2===(null!=d?d.length:void 0)&&/^\d+$/.test(d)&&(c=(new Date).getFullYear(),c=c.toString().slice(0,2),d=c+d),b=parseInt(b,10),d=parseInt(d,10),{month:b,year:d}},$.payment.validateCardNumber=function(b){var c,d;return b=(b+"").replace(/\s+|-/g,""),/^\d+$/.test(b)?(c=a(b),c?(d=b.length,w.call(c.length,d)>=0&&(c.luhn===!1||l(b))):!1):!1},$.payment.validateCardExpiry=function(a,b){var c,d,e;return"object"==typeof a&&"month"in a&&(e=a,a=e.month,b=e.year),a&&b?(a=$.trim(a),b=$.trim(b),/^\d+$/.test(a)&&/^\d+$/.test(b)&&a>=1&&12>=a?(2===b.length&&(b=70>b?"20"+b:"19"+b),4!==b.length?!1:(d=new Date(b,a),c=new Date,d.setMonth(d.getMonth()-1),d.setMonth(d.getMonth()+1,1),d>c)):!1):!1},$.payment.validateCardCVC=function(a,c){var d,e;return a=$.trim(a),/^\d+$/.test(a)?(d=b(c),null!=d?(e=a.length,w.call(d.cvcLength,e)>=0):a.length>=3&&a.length<=4):!1},$.payment.cardType=function(b){var c;return b?(null!=(c=a(b))?c.type:void 0)||null:null},$.payment.formatCardNumber=function(b){var c,d,e,f;return b=b.replace(/\D/g,""),(c=a(b))?(e=c.length[c.length.length-1],b=b.slice(0,e),c.format.global?null!=(f=b.match(c.format))?f.join(" "):void 0:(d=c.format.exec(b),null!=d?(d.shift(),d=$.grep(d,function(a){return a}),d.join(" ")):void 0)):b},$.payment.formatExpiry=function(a){var b,c,d,e;return(c=a.match(/^\D*(\d{1,2})(\D+)?(\d{1,4})?/))?(b=c[1]||"",d=c[2]||"",e=c[3]||"",e.length>0?d=" / ":" /"===d?(b=b.substring(0,1),d=""):2===b.length||d.length>0?d=" / ":1===b.length&&"0"!==b&&"1"!==b&&(b="0"+b,d=" / "),b+d+e):""}}.call(this),$(document).ready(function(){$(".support--forms").minnpost_givalike({minnpost_root:"http://minnpost.dev",debug:!0})}),function(a,b,c,d){function e(b,c){this.element=b,this.options=a.extend({},g,c),this._defaults=g,this._name=f,this.init()}var f="minnpost_givalike",g={debug:!1,minnpost_root:"https://www.minnpost.com",donate_form_selector:"#donate",confirm_form_selector:"#confirm",active:"panel--review",confirm:"panel--confirmation",query:"step",percentage:.05,pay_cc_processing_selector:'input[name="PaymentControl$cbPayFees"]',level_amount_selector:".amount .level-amount",frequency_selector:".frequency",full_amount_selector:".full-amount",level_indicator_selector:"h2.level",level_name_selector:".level-name",review_benefits_selector:".review-benefits",allow_upsell:!0,upsell_btn_selector:".btn--upsell",upsell_selector:".well--upsell",upsell_amount_selector:".upsell-amount",swag_selector:".swag",separate_swag_selector:"fieldset.swag--separate",separate_swag_redeem:".swag-redeem--separate",atlantic_status:'input[name="atlantic_status"]',atlantic_existing:"#atlantic_existing",atlantic_selector:".form-item--atlantic_id",name_selector:".form-item--display-name",honor_selector:".honor",notify_selector:"#notify",notify_field_selector:".form-item--memory-notify",anonymous_selector:"#PaymentControl_AdditionalInfoFields_AdditionalInfoCheckbox_3",needs_shipping_selector:".swag--shipping",shipping_address_selector:".form-item--shipping-address",use_for_shipping_selector:"#useforshipping",email_field_selector:"#PaymentControl_txtEmail",password_field_selector:"#password",firstname_field_selector:"#PaymentControl_txtFname",lastname_field_selector:"#PaymentControl_txtLname",city_field_selector:"#PaymentControl_txtBillCity",state_field_selector:"#PaymentControl_ddlBillState",zip_field_selector:"#PaymentControl_txtZip",create_mp_selector:"#creatempaccount",password_selector:".form-item--password",billing_selector:"fieldset.billing",shipping_selector:"fieldset.shipping",credit_card_fieldset:".credit-card-group",cc_num_selector:"#credit-card-number",cc_exp_selector:"#card-expiration",cc_cvv_selector:"#card-cvv",payment_button_selector:"#submit",confirm_button_selector:"#finish",newsletter_group_selector:'[name="newsletters"]',message_group_selector:'[name="messages"]',reason_field_selector:"#PaymentControl_AdditionalInfoFields_AdditionalInfoTextbox_1",share_reason_selector:"#PaymentControl_AdditionalInfoFields_AdditionalInfoLabel_2",confirm_top_selector:".support--post-confirm",levels:{1:{name:"bronze",max:60},2:{name:"silver",min:60,max:120},3:{name:"gold",min:120,max:240},4:{name:"platinum",min:240}},upsell:{bronze:!0,silver:9,gold:19,platinum:!1}};e.prototype={init:function(b,c){b!==!0?this.options.amount=parseFloat(a(this.options.level_amount_selector,this.element).text()):this.options.amount=c,this.options.frequency=parseFloat(a(this.options.frequency_selector,this.element).data("year-freq")),this.options.processing_percent=parseFloat(this.options.percentage),this.options.processing_fee=this.options.amount*this.options.processing_percent,this.options.new_amount=this.options.amount+this.options.processing_fee,this.options.processing_fee=parseFloat(this.options.processing_fee).toFixed(2),this.options.upsell_amount=parseFloat(a(this.options.upsell_amount_selector,this.element).text()),this.options.upsold=this.options.amount+this.options.upsell_amount,this.options.cardType=null,this.options.create_account=!1,this.options.debug===!0&&this.debug(this.options);var d=this.qs[this.options.query];"undefined"==typeof d&&(d=this.options.active),"undefined"!=typeof google&&google.hasOwnProperty("maps")?(a(this.options.billing_selector,this.element).prepend('<div class="form-item form-item--billing-address form-item--geocode"><label>Billing Address<input type="text" autocapitalize="off" autocorrect="off" name="full_address" id="full_address" class="geocomplete" placeholder=""></label><label class="additional-option"><input type="checkbox" name="useforshipping" id="useforshipping" checked="checked"> Use this address for shipping</label></div>'),a(this.options.shipping_selector,this.element).prepend('<div class="form-item form-item--shipping-address form-item--geocode"><label>Shipping Address<input type="text" autocapitalize="off" autocorrect="off" name="full_shipping_address" id="full_shipping_address" class="geocomplete" placeholder=""></label></div>'),this.getFullAddress()):(a(".form-item--nojs").show(),a(".form-item--nojs input").each(function(){a(this).attr("type","text")}),a(".form-item--geocode label:first").hide()),this.paymentPanels(d),this.creditCardProcessingFees(this.options,b),this.options.level=this.checkLevel(this.element,this.options,"name"),this.options.levelnum=this.checkLevel(this.element,this.options,"num"),this.upsell(this.element,this.options,this.options.amount,this.options.frequency),this.honorOrMemory(this.element,this.options),this.swag(this.element,this.options,!1),this.donateAnonymously(this.element,this.options),this.shippingAddress(this.element,this.options),this.allowMinnpostAccount(this.element,this.options,!1),this.creditCardFields(this.element,this.options),this.validateAndSubmit(this.element,this.options),this.confirmMessageSubmit(this.element,this.options)},qs:function(a){if(""===a)return{};for(var b={},c=0;c<a.length;++c){var d=a[c].split("=",2);1===d.length?b[d[0]]="":b[d[0]]=decodeURIComponent(d[1].replace(/\+/g," "))}return b}(b.location.search.substr(1).split("&")),debug:function(a){this.options.debug===!0&&("object"!=typeof a?console.log(a):console.dir(a),console.dir(this))},loadAnalytics:function(c){var d=b.gaq,e=this;d?(this.debug("we have analytics"),jQuery.each(c,function(b,f){if(e.debug("key is "+b+" and value is "+f),"object"==typeof f){var g=c.on,h=c.label(a(this)),i=f.selector,j=f.category,k=f.action;"undefined"!=typeof f.on&&(g=f.on),a(i).on(g,function(b){return c.debug===!0?(h="undefined"!=typeof f.label?f.label(a(this)):c.label(a(this)),this.debug("we did a "+g+" on the "+i+" object which has the category "+j+" and action "+k+" and label "+h),d("send","event",j,k,h),!1):void 0})}})):this.debug("Google Analaytics _gaq is not defined")},getQueryStrings:function(a){if(""===a)return{};a="?"+a.split("?")[1],a=a.substr(1).split("&");for(var b={},c=0;c<a.length;++c){var d=a[c].split("=",2);1===d.length?b[d[0]]="":b[d[0]]=decodeURIComponent(d[1].replace(/\+/g," "))}return b},getFullAddress:function(){a(".geocomplete").click(function(){a(this).trigger("geocode");var b=a(this).closest("fieldset").attr("data-geo");a(this).geocomplete({details:"form",detailsAttribute:b})})},paymentPanels:function(b){var c=this;a(".panel").hide(),a("#"+b).fadeIn(),a(".progress--donation li."+b+" a").addClass("active"),a(".progress--donation li a, a.btn.btn--next").click(function(b){b.preventDefault(),a(".progress--donation li a").removeClass("active");var d=a(this).attr("href"),e=c.getQueryStrings(d);e=e.step,a(".progress--donation li."+e+" a").addClass("active"),c.paymentPanels(e)})},creditCardProcessingFees:function(b,c){var d,e=this,f=!1;a(this.options.pay_cc_processing_selector).parent().html('<a href="#" class="add-credit-card-processing">Add $<span class="processing-amount"></span></a> to each transaction to cover MinnPost\'s credit card fees?'),a(".processing-amount").text(b.processing_fee),c===!0&&(f=!1,d=e.options.amount,a(".add-credit-card-processing").text("Add $"+e.options.processing_fee)),a(".add-credit-card-processing").click(function(c){a(".amount .level-amount").addClass("full-amount"),f?(f=!1,d=e.options.amount,a(".add-credit-card-processing").text("Add $"+b.processing_fee)):(f=!0,d=e.options.new_amount,a(".add-credit-card-processing").text("Remove $"+b.processing_fee)),a(".add-credit-card-processing").toggleClass("remove"),a(b.full_amount_selector).text(parseFloat(d).toFixed(2)),c.stopPropagation(),c.preventDefault()})},donateAnonymously:function(b,c){a(c.anonymous_selector,b).is(":checked")?a(c.name_selector+" label:first",b).hide():a(c.name_selector+" label:first",b).show(),a(c.anonymous_selector,b).change(function(){a(this).is(":checked")?a(c.name_selector+" label:first",b).hide():a(c.name_selector+" label:first",b).show()})},checkLevel:function(b,c,d){var e,f="",g=0,h="level level--",i=c.frequency,j=c.amount;12===i?e=j*i:1===i&&(e=j),a.each(c.levels,function(a,b){var c=b.name,d=a,i=b.max,j=b.min;if("undefined"!=typeof j&&"undefined"!=typeof i){if(e>=j&&i>e)return f=c,g=d,h+=d,!1}else if("undefined"!=typeof i){if(i>e)return f=c,g=d,h+=d,!1}else if("undefined"!=typeof j&&e>=j)return f=c,g=d,h+=d,!1}),a(c.level_indicator_selector,b).attr("class",h),a(c.level_name_selector).text(f.charAt(0).toUpperCase()+f.slice(1));var k=this.getQueryStrings(a(c.review_benefits_selector,b).attr("href"));k=k.level;var l=a(c.review_benefits_selector,b).attr("href");return l=l.replace(k,f),a(c.review_benefits_selector).attr("href",l),"name"===d?f:"num"===d?g:void 0},upsell:function(b,c,d,e){if(c.allow_upsell===!0){var f,g=this;12===e?f=d:1===e&&(f=d/e),a.each(c.upsell,function(d,e){d===c.level&&(e!==!0&&e>f||e===!1)&&a(c.upsell_selector,b).hide()}),a(c.upsell_btn_selector,b).click(function(d){var e=c.upsold;g.options.amount=e,a(c.level_amount_selector,b).text(e),a(c.full_amount_selector,b).text(e),a("#amount").val(e),a(this).remove(),d.stopPropagation(),d.preventDefault(),g.init(!0,e)})}else a(c.upsell_selector,b).hide()},honorOrMemory:function(b,d){var e=27;a(d.honor_selector+" fieldset").prepend('<a href="#" class="close">Close</a>'),a(d.honor_selector+" p a",b).click(function(){var c=a(this).attr("class");return a("fieldset."+c,b).addClass("visible").show(),!1}),a(d.honor_selector+" fieldset a.close",b).click(function(){var c=a(this).parent().attr("class").substring(0,a(this).parent().attr("class").length-8);return a("fieldset."+c,b).removeClass("visible").hide(),!1}),a(c).keyup(function(c){c.keyCode===e&&a("fieldset.visible",b).removeClass("visible").hide()}),a(d.notify_selector,b).is(":checked")?a(d.notify_field_selector,b).show():a(d.notify_field_selector,b).hide(),a(d.notify_selector,b).change(function(){a(this).is(":checked")?a(d.notify_field_selector,b).show():a(d.notify_field_selector,b).hide()})},swag:function(b,c,d){var e=this,f=e.options.levelnum;d===!1&&(a(c.swag_selector,b).hide(),a(c.swag_selector,b).filter(function(b){return a(this).attr("class").slice(-1)<=f}).show(),a(c.separate_swag_redeem,b).click(function(d){return d.stopImmediatePropagation(),a(c.separate_swag_selector,b).toggle(),!1})),a(c.atlantic_existing,b).is(":checked")?a(c.atlantic_selector,b).show():a(c.atlantic_selector,b).hide(),a(c.atlantic_status,b).change(function(){e.swag(b,c,!0)})},shippingAddress:function(b,c){var d=this,e=!1;e=!!a(c.needs_shipping_selector+":checked",b).length,a(c.needs_shipping_selector,b).change(function(){d.shippingAddress(b,c)}),a(c.needs_shipping_selector,b).length>0&&e===!0?(a(c.use_for_shipping_selector,b).parent().show(),a(c.use_for_shipping_selector,b).is(":checked")?a(c.shipping_address_selector,b).hide():a(c.shipping_address_selector,b).show(),a(c.use_for_shipping_selector,b).change(function(){d.shippingAddress(b,c)})):(a(c.shipping_address_selector,b).hide(),a(c.use_for_shipping_selector,b).parent().hide())},allowMinnpostAccount:function(b,c,d){function e(){var d=a(c.email_field_selector,b).val();h=g.checkMinnpostAccountExists(b,c,d)}var f,g=this,h=!1,i=5e3;a(c.email_field_selector,b).keyup(function(){clearTimeout(f),a(c.email_field_selector,b).val&&(f=setTimeout(e,i))}),a(c.create_mp_selector,b).is(":checked")?(a(c.password_selector,b).show(),c.create_account=!0):a(c.password_selector,b).hide(),a(c.create_mp_selector,b).change(function(){g.allowMinnpostAccount(b,c,!0)}),d===!1&&(a(c.password_selector,b).append('<div class="help-link"><span>Password help</span></div><div class="form-help">Password must be at least 6 characters.</div><label class="additional-option"><input type="checkbox" name="showpassword" id="showpassword"> Show password</label>'),a(c.create_mp_selector,b).parent().before('<p class="account-exists success">There is already a MinnPost.com account with this email.</p>'),a(".account-exists").hide(),a("#showpassword").click(function(){a(this).is(":checked")?a("#password").get(0).type="text":a("#password").get(0).type="password"}),a(".form-item .form-help").hide()),a(".form-item--with-help label, .form-item--with-help input").next(".help-link").click(function(){return a(this).next(".form-help").toggle(),!1})},checkMinnpostAccountExists:function(b,c,d){var e={email:d};a.ajax({method:"POST",url:c.minnpost_root+"/accounts/exists",data:e}).done(function(d){return"success"!==d.status||"user exists"!==d.reason?(a(c.create_mp_selector,b).is(":checked")?(a(c.password_selector,b).show(),c.create_account=!0):a(c.password_selector,b).hide(),a(".account-exists",b).hide(),!1):(a(c.create_mp_selector,b).is(":checked")&&(a(c.password_selector,b).hide(),a(c.create_mp_selector,b).parent().hide(),a(".account-exists",b).show()),void a(c.create_mp_selector,b).on("change",function(){a(c.create_mp_selector,b).is(":checked")&&(a(c.password_selector,b).hide(),a(c.create_mp_selector,b).parent().hide(),a(".account-exists",b).show())}))})},creditCardFields:function(b,c){"undefined"!=typeof a.payment&&(a('input[type="num"]').payment("restrictNumeric"),a(c.credit_card_fieldset+" input").focusin(function(){a(this).parent().addClass("focus")}).focusout(function(){a(this).parent().removeClass("focus")}),a(c.credit_card_fieldset,b).prepend('<span class="card-image"></span>'),a(c.cc_num_selector,b).payment("formatCardNumber"),a(c.cc_exp_selector,b).payment("formatCardExpiry"),a(c.cc_cvv_selector,b).payment("formatCardCVC"),a(c.cc_num_selector,b).on("keyup",function(){c.cardType=a.payment.cardType(a(c.cc_num_selector,b).val()),null!==c.cardType&&a(".card-image").attr("class","card-image "+c.cardType)}))},validateAndSubmit:function(b,c){var d=this;return a(c.donate_form_selector).submit(function(e){e.preventDefault();var f=!0,g=a.payment.validateCardNumber(a(c.cc_num_selector,b).val()),h=a.payment.validateCardExpiry(a(c.cc_exp_selector,b).payment("cardExpiryVal")),i=a.payment.validateCardCVC(a(c.cc_cvv_selector,b).val(),c.cardType);if(g===!1||h===!1||i===!1?(d.debug("cc "+g+" exp "+h+" cvv "+i),f=!1,a(c.cc_num_selector,b).parent().addClass("error"),g===!1?a(c.cc_num_selector,b).addClass("error"):(a(c.cc_exp_selector,b).removeClass("error"),a(c.cc_cvv_selector,b).removeClass("error")),h===!1?a(c.cc_exp_selector,b).addClass("error"):(a(c.cc_num_selector,b).removeClass("error"),a(c.cc_cvv_selector,b).removeClass("error")),i===!1?a(c.cc_cvv_selector,b).addClass("error"):(a(c.cc_num_selector,b).removeClass("error"),a(c.cc_exp_selector,b).removeClass("error"))):(a(c.cc_num_selector,b).parent().removeClass("error"),a(c.cc_num_selector,b).removeClass("error"),a(c.cc_exp_selector,b).removeClass("error"),a(c.cc_cvv_selector,b).removeClass("error")),f===!0){a(".progress--donation li a, .progress--donation li span").removeClass("active");var j=c.confirm;if(a(".progress--donation li."+j+" a, .progress--donation li."+j+" span").addClass("active"),d.paymentPanels(j),c.create_account===!0){var k={email:a(c.email_field_selector,b).val(),first:a(c.firstname_field_selector,b).val(),last:a(c.lastname_field_selector,b).val(),password:a(c.password_field_selector,b).val(),city:a(c.city_field_selector,b).val(),state:a(c.state_field_selector,b).val()};a.ajax({method:"POST",url:c.minnpost_root+"/accounts/create",data:k}).done(function(a){"success"===a.status&&"new user"===a.reason})}}}),!1},confirmMessageSubmit:function(b,c){return a(c.confirm_form_selector).submit(function(d){d.preventDefault();a(c.confirm_top_selector,b).prepend('<ul class="well well--messages"></ul>');var e=a(c.newsletter_group_selector+":checked"),f=a(c.message_group_selector+":checked");if("undefined"!=typeof e||"undefined"!=typeof f){a("ul.well--messages").append('<li class="mailchimp"></li>');var g={minnpost_mailchimp_js_form_action:"newsletter_subscribe",minnpost_mailchimp_email:a(c.email_field_selector,b).val(),minnpost_mailchimp_firstname:a(c.firstname_field_selector,b).val(),minnpost_mailchimp_lastname:a(c.lastname_field_selector,b).val(),minnpost_mailchimp_groups:{},minnpost_mailchimp_periodic:{}};"undefined"!=typeof e&&a.each(e,function(){var b=a(this).val();g.minnpost_mailchimp_groups[b]=b}),"undefined"!=typeof f&&a.each(f,function(){var b=a(this).val();g.minnpost_mailchimp_periodic[b]=b}),a.ajax({method:"POST",url:c.minnpost_root+"/mailchimp/minnpost/api",data:g}).done(function(c){"success"===c.status?(a(".well--messages").addClass("success"),a(".well--messages .mailchimp",b).html(c.message)):(a(".well--messages").addClass("error"),a(".well--messages .mailchimp",b).html(c.message))})}if(""!==a(c.reason_field_selector,b).val()){c.share_reason_selector.val(),c.reason_field_selector.val()}}),!1}},a.fn[f]=function(b){return this.each(function(){a.data(this,"plugin_"+f)||a.data(this,"plugin_"+f,new e(this,b))})}}(jQuery,window,document);