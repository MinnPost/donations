!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;((t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).payment||(t.payment={})).js=e()}}(function(){return function e(t,n,o){function r(i,a){if(!n[i]){if(!t[i]){var l="function"==typeof require&&require;if(!a&&l)return l(i,!0);if(s)return s(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var p=n[i]={exports:{}};t[i][0].call(p.exports,function(e){var n=t[i][1][e];return r(n||e)},p,p.exports,e,t,n,o)}return n[i].exports}for(var s="function"==typeof require&&require,i=0;i<o.length;i++)r(o[i]);return r}({1:[function(e,t,n){var o,r,s;(o=function(e){return o.isDOMElement(e)?e:document.querySelectorAll(e)}).isDOMElement=function(e){return e&&null!=e.nodeName},s=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,o.trim=function(e){return null===e?"":(e+"").replace(s,"")},r=/\r/g,o.val=function(e,t){var n;return arguments.length>1?e.value=t:"string"==typeof(n=e.value)?n.replace(r,""):null===n?"":n},o.preventDefault=function(e){if("function"!=typeof e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()},o.normalizeEvent=function(e){var t;return t=e,null==(e={which:null!=t.which?t.which:void 0,target:t.target||t.srcElement,preventDefault:function(){return o.preventDefault(t)},originalEvent:t,data:t.data||t.detail}).which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e},o.on=function(e,t,n){var r,s,i,a,l,c,p,d;if(e.length)for(s=0,a=e.length;s<a;s++)r=e[s],o.on(r,t,n);else{if(!t.match(" "))return p=n,n=function(e){return e=o.normalizeEvent(e),p(e)},e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?(t="on"+t,e.attachEvent(t,n)):void(e["on"+t]=n);for(i=0,l=(d=t.split(" ")).length;i<l;i++)c=d[i],o.on(e,c,n)}},o.addClass=function(e,t){var n;return e.length?function(){var r,s,i;for(i=[],r=0,s=e.length;r<s;r++)n=e[r],i.push(o.addClass(n,t));return i}():e.classList?e.classList.add(t):e.className+=" "+t},o.hasClass=function(e,t){var n,r,s,i;if(e.length){for(r=!0,s=0,i=e.length;s<i;s++)n=e[s],r=r&&o.hasClass(n,t);return r}return e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className)},o.removeClass=function(e,t){var n,r,s,i,a,l;if(e.length)return function(){var n,s,i;for(i=[],n=0,s=e.length;n<s;n++)r=e[n],i.push(o.removeClass(r,t));return i}();if(e.classList){for(l=[],s=0,i=(a=t.split(" ")).length;s<i;s++)n=a[s],l.push(e.classList.remove(n));return l}return e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")},o.toggleClass=function(e,t,n){var r;return e.length?function(){var s,i,a;for(a=[],s=0,i=e.length;s<i;s++)r=e[s],a.push(o.toggleClass(r,t,n));return a}():n?o.hasClass(e,t)?void 0:o.addClass(e,t):o.removeClass(e,t)},o.append=function(e,t){var n;return e.length?function(){var r,s,i;for(i=[],r=0,s=e.length;r<s;r++)n=e[r],i.push(o.append(n,t));return i}():e.insertAdjacentHTML("beforeend",t)},o.find=function(e,t){return(e instanceof NodeList||e instanceof Array)&&(e=e[0]),e.querySelectorAll(t)},o.trigger=function(e,t,n){var o;try{o=new CustomEvent(t,{detail:n})}catch(e){e,(o=document.createEvent("CustomEvent")).initCustomEvent?o.initCustomEvent(t,!0,!0,n):o.initEvent(t,!0,!0,n)}return e.dispatchEvent(o)},t.exports=o},{}],2:[function(e,t,n){(function(n){var o,r,s,i,a,l,c,p,d,u,_,h,m,f,v,g,y,w,b,x,C,k,S,P,T=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};r=e("qj/src/qj.coffee"),a=[{type:"amex",pattern:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[4],luhn:!0},{type:"dankort",pattern:/^5019/,format:l=/(\d{1,4})/g,length:[16],cvcLength:[3],luhn:!0},{type:"dinersclub",pattern:/^(36|38|30[0-5])/,format:l,length:[14],cvcLength:[3],luhn:!0},{type:"discover",pattern:/^(6011|65|64[4-9]|622)/,format:l,length:[16],cvcLength:[3],luhn:!0},{type:"jcb",pattern:/^35/,format:l,length:[16],cvcLength:[3],luhn:!0},{type:"laser",pattern:/^(6706|6771|6709)/,format:l,length:[16,17,18,19],cvcLength:[3],luhn:!0},{type:"maestro",pattern:/^(5018|5020|5038|6304|6703|6759|676[1-3])/,format:l,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"mastercard",pattern:/^5[1-5]/,format:l,length:[16],cvcLength:[3],luhn:!0},{type:"unionpay",pattern:/^62/,format:l,length:[16,17,18,19],cvcLength:[3],luhn:!1},{type:"visaelectron",pattern:/^4(026|17500|405|508|844|91[37])/,format:l,length:[16],cvcLength:[3],luhn:!0},{type:"visa",pattern:/^4/,format:l,length:[13,16],cvcLength:[3],luhn:!0},{type:"elo",pattern:/^4011|438935|45(1416|76)|50(4175|6699|67|90[4-7])|63(6297|6368)/,format:l,length:[16],cvcLength:[3],luhn:!0}],s=function(e){var t,n,o;for(e=(e+"").replace(/\D/g,""),n=0,o=a.length;n<o;n++)if((t=a[n]).pattern.test(e))return t},i=function(e){var t,n,o;for(n=0,o=a.length;n<o;n++)if((t=a[n]).type===e)return t},v=function(e){var t,n,o,r,s,i;for(s=!0,i=0,o=0,r=(n=(e+"").split("").reverse()).length;o<r;o++)t=n[o],t=parseInt(t,10),(s=!s)&&(t*=2),t>9&&(t-=9),i+=t;return i%10==0},f=function(e){var t;return null!=e.selectionStart&&e.selectionStart!==e.selectionEnd||!(null==("undefined"!=typeof document&&null!==document&&null!=(t=document.selection)?t.createRange:void 0)||!document.selection.createRange().text)},g=function(e){return setTimeout(function(){var t,n;return t=e.target,n=r.val(t),n=o.fns.formatCardNumber(n),r.val(t,n)})},d=function(e){var t,n,o,i,a,l,c;if(n=String.fromCharCode(e.which),/^\d+$/.test(n)&&(a=e.target,c=r.val(a),t=s(c+n),o=(c.replace(/\D/g,"")+n).length,l=16,t&&(l=t.length[t.length.length-1]),!(o>=l||null!=a.selectionStart&&a.selectionStart!==c.length)))return(i=t&&"amex"===t.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/).test(c)?(e.preventDefault(),r.val(a,c+" "+n)):i.test(c+n)?(e.preventDefault(),r.val(a,c+n+" ")):void 0},c=function(e){var t,n;if(t=e.target,n=r.val(t),!e.meta&&8===e.which&&(null==t.selectionStart||t.selectionStart===n.length))return/\d\s$/.test(n)?(e.preventDefault(),r.val(t,n.replace(/\d\s$/,""))):/\s\d?$/.test(n)?(e.preventDefault(),r.val(t,n.replace(/\s\d?$/,""))):void 0},u=function(e){var t,n,o;if(t=String.fromCharCode(e.which),/^\d+$/.test(t))return n=e.target,o=r.val(n)+t,/^\d$/.test(o)&&"0"!==o&&"1"!==o?(e.preventDefault(),r.val(n,"0"+o+" / ")):/^\d\d$/.test(o)?(e.preventDefault(),r.val(n,o+" / ")):void 0},m=function(e){var t,n,o;if(t=String.fromCharCode(e.which),/^\d+$/.test(t))return n=e.target,o=r.val(n)+t,/^\d$/.test(o)&&"0"!==o&&"1"!==o?(e.preventDefault(),r.val(n,"0"+o)):/^\d\d$/.test(o)?(e.preventDefault(),r.val(n,""+o)):void 0},_=function(e){var t,n,o;if(t=String.fromCharCode(e.which),/^\d+$/.test(t))return n=e.target,o=r.val(n),/^\d\d$/.test(o)?r.val(n,o+" / "):void 0},h=function(e){var t,n;if("/"===String.fromCharCode(e.which))return t=e.target,n=r.val(t),/^\d$/.test(n)&&"0"!==n?r.val(t,"0"+n+" / "):void 0},p=function(e){var t,n;if(!e.metaKey&&(t=e.target,n=r.val(t),8===e.which&&(null==t.selectionStart||t.selectionStart===n.length)))return/\d(\s|\/)+$/.test(n)?(e.preventDefault(),r.val(t,n.replace(/\d(\s|\/)*$/,""))):/\s\/\s?\d?$/.test(n)?(e.preventDefault(),r.val(t,n.replace(/\s\/\s?\d?$/,""))):void 0},k=function(e){var t;return!(!e.metaKey&&!e.ctrlKey)||(32===e.which?e.preventDefault():0===e.which||(e.which<33||(t=String.fromCharCode(e.which),/[\d\s]/.test(t)?void 0:e.preventDefault())))},w=function(e){var t,n,o,i;if(o=e.target,n=String.fromCharCode(e.which),/^\d+$/.test(n)&&!f(o))if(i=(r.val(o)+n).replace(/\D/g,""),t=s(i)){if(!(i.length<=t.length[t.length.length-1]))return e.preventDefault()}else if(!(i.length<=16))return e.preventDefault()},x=function(e,t){var n,o,s;if(o=e.target,n=String.fromCharCode(e.which),/^\d+$/.test(n)&&!f(o))return s=r.val(o)+n,(s=s.replace(/\D/g,"")).length>t?e.preventDefault():void 0},b=function(e){return x(e,6)},C=function(e){return x(e,2)},S=function(e){return x(e,4)},y=function(e){var t,n;if(n=e.target,t=String.fromCharCode(e.which),/^\d+$/.test(t)&&!f(n))return(r.val(n)+t).length<=4?void 0:e.preventDefault()},P=function(e){var t,n,s,i,l;if(i=e.target,l=r.val(i),s=o.fns.cardType(l)||"unknown",!r.hasClass(i,s))return t=function(){var e,t,o;for(o=[],e=0,t=a.length;e<t;e++)n=a[e],o.push(n.type);return o}(),r.removeClass(i,"unknown"),r.removeClass(i,t.join(" ")),r.addClass(i,s),r.toggleClass(i,"identified","unknown"!==s),r.trigger(i,"payment.cardType",s)},o=function(){function e(){}return e.fns={cardExpiryVal:function(e){var t,n,o;return e=e.replace(/\s/g,""),n=e.split("/",2),t=n[0],2===(null!=(o=n[1])?o.length:void 0)&&/^\d+$/.test(o)&&(o=(new Date).getFullYear().toString().slice(0,2)+o),t=parseInt(t,10),o=parseInt(o,10),{month:t,year:o}},validateCardNumber:function(e){var t,n;return e=(e+"").replace(/\s+|-/g,""),!!/^\d+$/.test(e)&&(!!(t=s(e))&&(n=e.length,T.call(t.length,n)>=0&&(!1===t.luhn||v(e))))},validateCardExpiry:function(e,t){var n,o,s;return"object"==typeof e&&"month"in e&&(e=(s=e).month,t=s.year),!(!e||!t)&&(e=r.trim(e),t=r.trim(t),!!/^\d+$/.test(e)&&(!!/^\d+$/.test(t)&&(parseInt(e,10)<=12&&(2===t.length&&(t=(new Date).getFullYear().toString().slice(0,2)+t),o=new Date(t,e),n=new Date,o.setMonth(o.getMonth()-1),o.setMonth(o.getMonth()+1,1),o>n))))},validateCardCVC:function(e,t){var n,o;return e=r.trim(e),!!/^\d+$/.test(e)&&(t&&i(t)?(n=e.length,T.call(null!=(o=i(t))?o.cvcLength:void 0,n)>=0):e.length>=3&&e.length<=4)},cardType:function(e){var t;return e?(null!=(t=s(e))?t.type:void 0)||null:null},formatCardNumber:function(e){var t,n,o,r;return(t=s(e))?(r=t.length[t.length.length-1],e=e.replace(/\D/g,""),e=e.slice(0,+r+1||9e9),t.format.global?null!=(o=e.match(t.format))?o.join(" "):void 0:(null!=(n=t.format.exec(e))&&n.shift(),null!=n?n.join(" "):void 0)):e}},e.restrictNumeric=function(e){return r.on(e,"keypress",k)},e.cardExpiryVal=function(t){return e.fns.cardExpiryVal(r.val(t))},e.formatCardCVC=function(t){return e.restrictNumeric(t),r.on(t,"keypress",y),t},e.formatCardExpiry=function(t){var n,o;return e.restrictNumeric(t),t.length&&2===t.length?(n=t[0],o=t[1],this.formatCardExpiryMultiple(n,o)):(r.on(t,"keypress",b),r.on(t,"keypress",u),r.on(t,"keypress",h),r.on(t,"keypress",_),r.on(t,"keydown",p)),t},e.formatCardExpiryMultiple=function(e,t){return r.on(e,"keypress",C),r.on(e,"keypress",m),r.on(t,"keypress",S)},e.formatCardNumber=function(t){return e.restrictNumeric(t),r.on(t,"keypress",w),r.on(t,"keypress",d),r.on(t,"keydown",c),r.on(t,"keyup",P),r.on(t,"paste",g),t},e.getCardArray=function(){return a},e.setCardArray=function(e){return a=e,!0},e.addToCardArray=function(e){return a.push(e)},e.removeFromCardArray=function(e){var t;for(t in a)a[t].type===e&&a.splice(t,1);return!0},e}(),t.exports=o,n.Payment=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"qj/src/qj.coffee":1}]},{},[2])(2)}),function(e,t,n,o){function r(t,n){this.element=t,this.options=e.extend({},a,n),this._defaults=a,this._name=s,this.init()}var s="minnpost_giving",a={debug:!1,tabs:!0,stripe_publishable_key:"",plaid_env:"",plaid_public_key:"",plaid_link:"#authorize-ach",minnpost_root:"https://www.minnpost.com",donate_form_selector:"#donate",review_step_selector:"#panel--review",attendees_step_selector:"#panel--attendees",donate_step_selector:"#panel--pay",confirm_form_selector:"#confirm",confirm_step_selector:"#panel--confirmation",active:"panel--review",confirm:"panel--confirmation",query:"step",percentage:.022,fixed_amount:.3,amex_percentage:.035,ach_percentage:.008,pay_cc_processing_selector:'input[id="edit-pay-fees"]',level_amount_selector:"#panel--review .amount .level-amount",original_amount_selector:"#amount",frequency_selector:".frequency",full_amount_selector:".full-amount",level_indicator_selector:"h2.level",level_name_selector:".level-name",review_benefits_selector:".review-benefits",allow_upsell:!0,upsell_btn_selector:".btn--upsell",upsell_selector:".well--upsell",upsell_amount_selector:".upsell-amount",swag_selector:".swag",separate_swag_selector:"fieldset.swag--separate",separate_swag_redeem:".swag-redeem--separate",swag_selector_choose_multiple:".swag--choose-multiple",swag_choose_multiple_name:"swag_thankyou",atlantic_status:'input[name="swag_atlanticsubscription"]',atlantic_existing:"#atlantic_existing",atlantic_selector:".form-item--atlantic_id",name_selector:".form-item--display-name",honor_selector:".honor",notify_selector:".notify_someone",notify_field_selector:".form-item--notify",anonymous_selector:"#edit-anonymous",show_billing_country_selector:"#billing_show_country",billing_country_selector:".form-item--country",show_shipping_country_selector:"#shipping_show_country",shipping_country_selector:".form-item--shipping-country",shipping_address_selector:".form-item--shipping-address",use_for_shipping_selector:"#useforshipping",email_field_selector:"#edit-email",password_field_selector:"#password",first_name_field_selector:"#first_name",last_name_field_selector:"#last_name",account_city_selector:"#billing_city",account_state_selector:"#billing_state",account_zip_selector:"#billing_zip",create_mp_selector:"#creatempaccount",password_selector:".form-item--password",calculated_amount_selector:".calculated-amount",quantity_field:"#quantity",quantity_selector:".quantity",item_selector:".purchase-item",single_unit_price_attribute:"unit-price",additional_amount_field:"#additional_donation",additional_amount_selector:".additional_donation",has_additional_text_selector:".has_additional",promo_selector:".form-item--promo-code",use_promocode_selector:"#use-promo-code",promocode_selector:"#promo_code",event_id_selector:"#event",calendar_button_selector:".addeventatc",billing_selector:"fieldset.billing",shipping_selector:"fieldset.shipping",credit_card_fieldset:".payment-method-group",choose_payment:"#choose-payment-method",payment_method_selector:".payment-method",cc_num_selector:"#cc-number",cc_exp_selector:"#cc-exp",cc_cvv_selector:"#cc-cvc",payment_button_selector:"#submit",confirm_button_selector:"#finish",opp_id_selector:"#flask_id",recurring_selector:"#recurring",newsletter_group_selector:'[name="newsletters"]',message_group_selector:'[name="messages"]',reason_field_selector:"#reason_for_supporting",share_reason_selector:"#reason_shareable",confirm_top_selector:".support--post-confirm",existing_newsletter_settings:"",levels:{1:{name:"bronze",max:60},2:{name:"silver",min:60,max:120},3:{name:"gold",min:120,max:240},4:{name:"platinum",min:240}},upsell:{bronze:!0,silver:9,gold:19,platinum:!1}};r.prototype={init:function(t,o){this.options.amount=!0!==t?parseFloat(e(this.options.level_amount_selector,this.element).text()):o,this.options.original_amount=parseInt(e(this.options.original_amount_selector,this.element).val(),10),this.options.frequency=parseFloat(e(this.options.frequency_selector,this.element).attr("data-year-freq"));var r=e(this.options.recurring_selector,this.element).val();void 0!==r&&(this.options.recurring=r.charAt(0).toUpperCase()+r.slice(1)),this.options.processing_percent=parseFloat(this.options.percentage),this.options.fixed_fee=parseFloat(this.options.fixed_amount),this.options.new_amount=(this.options.original_amount+this.options.fixed_fee)/(1-this.options.processing_percent),this.options.processing_fee=this.options.new_amount-this.options.original_amount,this.options.processing_fee=(Math.round(parseFloat(this.options.processing_fee)*Math.pow(10,2))/Math.pow(10,2)).toFixed(2),this.options.processing_fee_text=this.options.processing_fee,this.options.upsell_amount=parseFloat(e(this.options.upsell_amount_selector,this.element).text()),this.options.upsold=this.options.amount+this.options.upsell_amount,this.options.cardType=null,this.options.create_account=!1;var s=e("button.give, input.give").text();this.options.button_text=s,Stripe.setPublishableKey(this.options.stripe_publishable_key),""!==n.referrer&&e("#edit_url").prop("href",n.referrer),!0===this.options.debug&&this.debug(this.options);var i=this.qs[this.options.query];void 0===i&&(i=this.options.active),this.paymentPanels(i),e(this.options.pay_cc_processing_selector).length>0&&(this.creditCardProcessingFees(this.options,t),e(this.options.credit_card_fieldset).prepend('<input type="hidden" id="edit-pay-fees" name="pay_fees" value="0" />')),e(this.options.review_step_selector).length>0&&(this.options.level=this.checkLevel(this.element,this.options,"name"),this.options.levelnum=this.checkLevel(this.element,this.options,"num"),this.honorOrMemory(this.element,this.options),this.swag(this.element,this.options,!1),this.upsell(this.element,this.options,this.options.amount,this.options.frequency)),e(this.options.donate_step_selector).length>0&&(this.donateAnonymously(this.element,this.options),this.outsideUnitedStates(this.element,this.options),this.shippingAddress(this.element,this.options),this.allowMinnpostAccount(this.element,this.options,!1),this.creditCardFields(this.element,this.options),this.achFields(this.element,this.options),this.validateAndSubmit(this.element,this.options)),e(this.options.calculated_amount_selector).length>0&&this.calculateAmount(this.element,this.options,""),e(this.options.use_promocode_selector).length>0&&this.usePromoCode(this.element,this.options),e(this.options.calendar_button_selector).length>0&&this.addToCalendar(this.element,this.options),e(this.options.confirm_step_selector).length>0&&(this.showNewsletterSettings(this.element,this.options),this.confirmMessageSubmit(this.element,this.options))},qs:function(e){if(""===e)return{};for(var t={},n=0;n<e.length;++n){var o=e[n].split("=",2);1===o.length?t[o[0]]="":t[o[0]]=decodeURIComponent(o[1].replace(/\+/g," "))}return t}(t.location.search.substr(1).split("&")),debug:function(e){!0===this.options.debug&&("object"!=typeof e?console.log(e):console.dir(e),console.dir(this))},getQueryStrings:function(e){if(void 0===e||""===e)return{};e=(e="?"+e.split("?")[1]).substr(1).split("&");for(var t={},n=0;n<e.length;++n){var o=e[n].split("=",2);1===o.length?t[o[0]]="":t[o[0]]=decodeURIComponent(o[1].replace(/\+/g," "))}return t},paymentPanels:function(t){var o=this,r=this.options.tabs,s="MinnPost | Support Us | ",i=e(".progress--donation li."+t).text(),a=(e(".progress--donation li."+t).next().text(),e(".progress--donation li."+t).index()+1),l=e(".progress--donation li").length;e(this.options.opp_id_selector).val();e(this.options.confirm_step_selector).length>0&&(t=this.options.confirm,e(".progress--donation li."+t+" span").addClass("active"),a=e(".progress--donation li."+t).index()+1,e(this.options.confirm_button_selector).length>0&&(l+=1)),a===l-1&&e(this.options.opp_id_selector).length>0?a="purchase":a===l&&e(this.options.opp_id_selector).length>0?a="purchase":a===l&&e(this.options.opp_id_selector).length,n.title=s+i,this.analyticsTrackingStep(a,s),!0===r?e(".panel").hide():e(".panel").show(),0===e(".progress--donation li .active").length?(e("#"+t).fadeIn(),e(".progress--donation li."+t+" a").addClass("active")):(t=e(".progress--donation li .active").parent().prop("class"),e("#"+t).fadeIn()),e(".progress--donation li a, a.btn.btn--next").click(function(t){t.preventDefault(),e(".progress--donation li a").removeClass("active");var n=e(this).prop("href"),r=o.getQueryStrings(n);r=r.step,e(".progress--donation li."+r+" a").addClass("active"),o.paymentPanels(r)})},analyticsTrackingStep:function(n,o){var r=this.checkLevel(this.element,this.options,"name"),s=(this.checkLevel(this.element,this.options,"num"),e(this.options.original_amount_selector).val()),i=this.options.recurring,a=e(this.options.opp_id_selector).val();ga("ec:addProduct",{id:"minnpost_"+r.toLowerCase()+"_membership",name:"MinnPost "+r.charAt(0).toUpperCase()+r.slice(1)+" Membership",category:"Donation",brand:"MinnPost",variant:i,price:s,quantity:1}),"purchase"===n?ga("ec:setAction","purchase",{id:a,affiliation:"MinnPost",revenue:s}):ga("ec:setAction","checkout",{step:n}),ga("set",{page:t.location.pathname,title:o}),ga("send","pageview",t.location.pathname)},calculateFees:function(e){this.options.fixed_fee=parseFloat(this.options.fixed_amount);var t=this.options.percentage,n=(this.options.fixed_amount,this.options.fixed_fee);"amex"===e?(t=this.options.amex_percentage,0,n=0):"ach"===e&&(t=this.options.ach_percentage,0,n=0),this.options.processing_percent=parseFloat(t),this.options.new_amount=(this.options.original_amount+n)/(1-this.options.processing_percent),this.options.processing_fee=this.options.new_amount-this.options.original_amount,this.options.processing_fee=(Math.round(parseFloat(this.options.processing_fee)*Math.pow(10,2))/Math.pow(10,2)).toFixed(2),this.options.processing_fee_text=this.options.processing_fee},creditCardProcessingFees:function(t,n){var o,r=this,s=!1;e(this.options.pay_cc_processing_selector).parent().html('<a href="#" class="add-credit-card-processing">Add $<span class="processing-amount"></span></a> <span class="processing-explain">to each transaction to cover MinnPost\'s credit card fees?</span>'),e(".processing-amount").text(t.processing_fee_text),this.options.original_amount!=this.options.amount&&(e(".add-credit-card-processing").text("Remove $"+t.processing_fee_text),e("#edit-pay-fees").val(1),s=!0,e(".processing-explain").hide()),!0===n&&(s=!1,o=r.options.original_amount,e(".add-credit-card-processing").text("Add $"+r.options.processing_fee_text),e("#edit-pay-fees").val(0),e(".processing-explain").show()),e(".add-credit-card-processing").click(function(n){e(".amount .level-amount").addClass("full-amount"),s?(s=!1,o=r.options.original_amount,e(".add-credit-card-processing").text("Add $"+t.processing_fee_text),e("#edit-pay-fees").val(0),e(".processing-explain").show()):(s=!0,o=r.options.new_amount,e(".add-credit-card-processing").text("Remove $"+t.processing_fee_text),e("#edit-pay-fees").val(1),e(".processing-explain").hide()),e(".add-credit-card-processing").toggleClass("remove"),e(t.full_amount_selector).text(parseFloat(o).toFixed(2)),n.stopPropagation(),n.preventDefault()})},donateAnonymously:function(t,n){e(n.anonymous_selector,t).is(":checked")?e(n.name_selector+" div:first",t).hide():e(n.name_selector+" div:first",t).show(),e(n.anonymous_selector,t).change(function(){e(this).is(":checked")?e(n.name_selector+" div:first",t).hide():e(n.name_selector+" div:first",t).show()})},checkLevel:function(t,n,o){var r,s="",i=0,a="level level--",l=n.frequency,c=n.original_amount;if(12===l?r=c*l:1===l&&(r=c),e.each(n.levels,function(e,t){var n=t.name,o=e,l=t.max,c=t.min;if(void 0!==c&&void 0!==l){if(r>=c&&r<l)return s=n,i=o,a+=o,!1}else if(void 0!==l){if(r<l)return s=n,i=o,a+=o,!1}else if(void 0!==c&&r>=c)return s=n,i=o,a+=o,!1}),e(n.level_indicator_selector).length>0&&e(n.review_benefits_selector).length>0){e(n.level_indicator_selector,t).prop("class",a),e(n.level_name_selector).text(s.charAt(0).toUpperCase()+s.slice(1));var p=this.getQueryStrings(e(n.review_benefits_selector,t).prop("href"));p=p.level;var d=e(n.review_benefits_selector,t).prop("href");d=d.replace(p,s),e(n.review_benefits_selector).prop("href",d)}return"name"===o?s:"num"===o?i:void 0},upsell:function(t,n,o,r){if(!0===n.allow_upsell){var s,i=this;12===r?s=o:1===r&&(s=o/r),e.each(n.upsell,function(o,r){o===n.level&&(!0!==r&&s<r||!1===r)&&e(n.upsell_selector,t).hide()}),e(n.upsell_btn_selector,t).click(function(o){var r=n.upsold;i.options.amount=r,e(n.level_amount_selector,t).text(r),e(n.full_amount_selector,t).text(r),e(n.original_amount_selector,t).val(r),e(this).remove(),o.stopPropagation(),o.preventDefault(),i.init(!0,r)})}else e(n.upsell_selector,t).hide()},honorOrMemory:function(t,o){e(o.honor_selector+" fieldset").prepend('<a href="#" class="close">Close</a>'),e(o.honor_selector+" p a",t).click(function(){var n=e(this).prop("class");return e("fieldset."+n,t).addClass("visible").show(),!1}),e(o.honor_selector+" fieldset a.close",t).click(function(){var n=e(this).parent().prop("class").substring(0,e(this).parent().prop("class").length-8);return e("fieldset."+n,t).removeClass("visible").hide(),!1}),e(n).keyup(function(n){27===n.keyCode&&e("fieldset.visible",t).removeClass("visible").hide()}),e(o.notify_selector,t).is(":checked")?e(o.notify_field_selector,t).show():e(o.notify_field_selector,t).hide(),e(o.notify_selector,t).change(function(){e(this).is(":checked")?e(o.notify_field_selector,t).show():e(o.notify_field_selector,t).hide()})},swag:function(t,n,o){var r=this,s=r.options.levelnum;!1===o&&(e(n.swag_selector,t).hide(),e(n.swag_selector,t).filter(function(t){return e(this).prop("class").slice(-1)<=s}).show(),e(n.separate_swag_redeem,t).click(function(o){return o.stopImmediatePropagation(),e(n.separate_swag_selector,t).toggle(),!1})),e(n.atlantic_existing,t).is(":checked")?e(n.atlantic_selector,t).show():e(n.atlantic_selector,t).hide(),e(n.atlantic_status,t).change(function(){r.swag(t,n,!0)});var i=e(n.swag_selector_choose_multiple,t).data("maximum-choose");e(n.swag_selector_choose_multiple,t).show(),e(n.swag_selector_choose_multiple,t).find("label, .swag").show();var a=e(n.swag_selector_choose_multiple+' input[name="'+n.swag_choose_multiple_name+'"]:checked').length;e("input",n.swag_selector_choose_multiple).change(function(){"checkbox"==e(this).prop("type")&&(a=e(n.swag_selector_choose_multiple+' input[name="'+n.swag_choose_multiple_name+'"]:checked').length,i===a?e("input:not(:checked)",n.swag_selector_choose_multiple).attr("disabled",!0):e("input:not(:checked)",n.swag_selector_choose_multiple).attr("disabled",!1))})},outsideUnitedStates:function(t,n){e(n.show_billing_country_selector).click(function(){return e(n.billing_country_selector).show(),e(this).parent().hide(),!1}),e(n.show_shipping_country_selector).click(function(){return e(n.shipping_country_selector).show(),e(this).parent().hide(),!1})},shippingAddress:function(t,n){var o=this,r=!1;e(n.use_for_shipping_selector).length>0&&(r=!0),!0===r&&(e(n.use_for_shipping_selector,t).parent().show(),e(n.use_for_shipping_selector,t).is(":checked")?e(n.shipping_selector).hide():e(n.shipping_selector).show(),e(n.use_for_shipping_selector,t).change(function(){o.shippingAddress(t,n)}))},allowMinnpostAccount:function(t,n,o){function r(){var o=e(n.email_field_selector,t).val();a=i.checkMinnpostAccountExists(t,n,o)}var s,i=this,a=!1;e(n.email_field_selector,t).keyup(function(){clearTimeout(s),e(n.email_field_selector,t).val&&(s=setTimeout(r,5e3))}),e(n.create_mp_selector,t).is(":checked")?(e(n.password_selector,t).show(),n.create_account=!0):e(n.password_selector,t).hide(),e(n.create_mp_selector,t).change(function(){i.allowMinnpostAccount(t,n,!0)}),!1===o&&(e(n.password_selector,t).append('<div class="help-link"><span>Password help</span></div><div class="form-help">Password must be at least 6 characters.</div><label class="additional-option"><input type="checkbox" name="showpassword" id="showpassword"> Show password</label>'),e(n.create_mp_selector,t).parent().before('<p class="account-exists success">There is already a MinnPost.com account with this email.</p>'),e(".account-exists").hide(),e("#showpassword").click(function(){e(this).is(":checked")?e("#password").get(0).type="text":e("#password").get(0).type="password"}),e(".form-item .form-help").hide()),e(".form-item--with-help label, .form-item--with-help input").next(".help-link").click(function(){return e(this).next(".form-help").toggle(),!1})},populateAttendees:function(t){var n="",o=e(".attendees > fieldset:first").html();for(i=1;i<=t;i++)n+='<fieldset class="attendee">'+o.replace(/_1/g,"_"+i)+"</fieldset>";e(".attendees").html(n)},displayAmount:function(t,n,o,r,s,i){var a=o*parseInt(r,10);""===s?(s=0,e(n.create_mp_selector).parent().hide()):(a+=parseInt(s,10),levelcheck={original_amount:s,frequency:1,levels:n.levels},level=this.checkLevel(t,levelcheck,"num"),level>=2&&e(n.create_mp_selector).parent().show(),e(n.has_additional_text_selector).html(e(n.has_additional_text_selector).data("text")),e(n.additional_amount_selector).text(parseFloat(e(n.additional_amount_field).val()))),e(n.calculated_amount_selector).text(a),e(n.original_amount_selector).val(r*o),e(n.quantity_selector).text(r),1==r?e(".attendee-title").text(e(".attendee-title").data("single")):e(".attendee-title").text(e(".attendee-title").data("plural")),e(".code-result").remove(),!0===i?(e(".apply-promo-code").after('<p class="code-result success">Your member discount code was successfully added.</p>'),e(".show-"+n.single_unit_price_attribute).text(o),e(".apply-promo-code").text("Applied").addClass("btn--disabled")):!1===i&&e(".apply-promo-code").after('<p class="code-result error">This code is incorrect. Try again.</p>')},calculateAmount:function(t,n,o){var r=this,s=e(n.quantity_field).val(),i=e(n.quantity_field).data(n.single_unit_price_attribute),a=e(n.additional_amount_field).val();!0===o.success&&(i=o.single_unit_price),r.displayAmount(t,n,i,s,a,o.success),e(n.quantity_field+", "+n.additional_amount_field).change(function(){s=e(n.quantity_field).val(),a=e(n.additional_amount_field).val(),1!=s?e(n.item_selector).text(e(n.item_selector).data("plural")):e(n.item_selector).text(e(n.item_selector).data("single")),r.displayAmount(t,n,i,s,a)});var l="";e(n.review_step_selector).find(".btn").click(function(){l=r.populateAttendees(s)}),e(".progress--donation .panel--attendees").find("a").click(function(){l=r.populateAttendees(s)}),e(this.options.promocode_selector).length>0&&e(".apply-promo-code").click(function(o){var s=e(n.promocode_selector,t).val();if(e(n.event_id_selector).length>0)i=e(n.event_id_selector,t).val();else var i=1;o.preventDefault();var a={promo_code:s,event:i};e.ajax({method:"POST",url:"/event-check-promo/",data:a}).done(function(e){r.calculateAmount(t,n,e)})})},checkPromoCode:function(t){var n={promo_code:t};e.ajax({method:"POST",url:"/event-check-promo/",data:n}).done(function(e){return!0===e.success})},usePromoCode:function(t,n){e(this.options.use_promocode_selector).parent().html('<a href="#" class="use-promo-code">Use promo code</a>'),""===e(this.options.promocode_selector).val()?e(n.promo_selector+" div:first",t).hide():e(n.promo_selector+" div:last",t).hide(),e(".use-promo-code").click(function(o){e(n.promo_selector+" div:first",t).show(),e(n.promo_selector+" div:last",t).hide(),o.preventDefault()})},addToCalendar:function(t,n){e(n.calendar_button_selector).css("display","inline-block")},checkMinnpostAccountExists:function(t,n,o){var r={email:o};e.ajax({method:"POST",url:n.minnpost_root+"/accounts/exists",data:r}).done(function(o){if("success"!==o.status||"user exists"!==o.reason)return e(n.create_mp_selector,t).is(":checked")?(e(n.password_selector,t).show(),n.create_account=!0):e(n.password_selector,t).hide(),e(".account-exists",t).hide(),!1;e(n.create_mp_selector,t).is(":checked")&&(e(n.password_selector,t).hide(),e(n.create_mp_selector,t).parent().hide(),e(".account-exists",t).show()),e(n.create_mp_selector,t).on("change",function(){e(n.create_mp_selector,t).is(":checked")&&(e(n.password_selector,t).hide(),e(n.create_mp_selector,t).parent().hide(),e(".account-exists",t).show())})})},creditCardFields:function(t,n){var o=this;if(e(n.choose_payment).length>0){if(e(n.choose_payment+" input").is(":checked")){var r=e(n.choose_payment+" input:checked").attr("id");e(n.payment_method_selector).removeClass("active"),e(n.payment_method_selector+"."+r).addClass("active"),e(n.payment_method_selector+":not(.active) label").removeClass("required"),e(n.payment_method_selector+":not(.active) input").prop("required",!1),e(n.payment_method_selector+".active label").addClass("required"),e(n.payment_method_selector+".active input").prop("required",!0)}e(n.choose_payment+" input").change(function(t){e(n.payment_method_selector).removeClass("active"),e(n.payment_method_selector+"."+this.id).addClass("active"),e(n.payment_method_selector+":not(.active) label").removeClass("required"),e(n.payment_method_selector+":not(.active) input").prop("required",!1),e(n.payment_method_selector+".active label").addClass("required"),e(n.payment_method_selector+".active input").prop("required",!0),e("#bankToken").remove()})}"undefined"!=typeof Payment&&(Payment.formatCardNumber(e(n.cc_num_selector,t)),Payment.formatCardExpiry(e(n.cc_exp_selector,t)),Payment.formatCardCVC(e(n.cc_cvv_selector,t)),e(n.cc_num_selector,t).parent().prepend('<span class="card-image"></span>'),e(n.cc_num_selector,t).keyup(function(){n.cardType=Payment.fns.cardType(e(n.cc_num_selector,t).val()),null!==n.cardType&&o.calculateFees(n.cardType),e(".add-credit-card-processing").text("Add $"+o.options.processing_fee_text),e("#edit-pay-fees").val(0),e(".card-image").prop("class","card-image "+e("#cc-number").prop("class"))}))},achFields:function(t,n){var o=this;if(""!=n.plaid_env&&""!=n.key&&"undefined"!=typeof Plaid){var r=Plaid.create({selectAccount:!0,apiVersion:"v2",env:n.plaid_env,clientName:"MinnPost",key:n.plaid_public_key,product:"auth",onLoad:function(){},onSuccess:function(r,s){var i=e(n.donate_form_selector);i.append(e('<input type="hidden" name="public_token" />').val(r)),i.append(e('<input type="hidden" name="account_id" />').val(s.account_id)),e.ajax({url:"/plaid_token/",data:e(i).serialize(),type:"POST"}).done(function(r){void 0!==r.error?e(n.plaid_link).parent().after('<p class="error">'+r.error+"</p>"):(e(n.donate_form_selector).prepend('<input type="hidden" id="bankToken" name="bankToken" value="'+r.stripe_bank_account_token+'" />'),e(n.plaid_link,t).html("<strong>Your account was successfully authorized</strong>").contents().unwrap(),o.calculateFees("ach"),e(".add-credit-card-processing").text("Add $"+o.options.processing_fee_text),e("#edit-pay-fees").val(0))}).error(function(t){e(n.plaid_link).parent().after('<p class="error">'+t.error+"</p>")})},onExit:function(e,t){}});e(n.plaid_link,t).click(function(t){t.preventDefault(),e(n.payment_method_selector+" .error").remove(),r.open()})}},hasHtml5Validation:function(e,t){return"function"==typeof n.createElement("input").checkValidity},buttonStatus:function(e,t,n){t.prop("disabled",n),!1===n?t.text(e.button_text):t.text("Processing")},validateAndSubmit:function(t,o){var r=this;e(this.options.donate_form_selector).prepend('<input type="hidden" id="source" name="source" value="'+n.referrer+'" />'),e(o.donate_form_selector).submit(function(n){n.preventDefault(),r.hasHtml5Validation(t,o)&&(this.checkValidity()?(e(this).removeClass("invalid"),e(this).find("input:invalid").parent().removeClass("error")):(e(this).addClass("invalid"),e("html, body").animate({scrollTop:e(this).find("input:invalid").parent().offset().top},2e3),e(this).find("input:invalid").parent().addClass("error"))),e(".check-field, .card-instruction").remove(),e("input, label",t).removeClass("error");var s=!0,i="card";if(e(o.choose_payment).length>0&&(i=e(o.choose_payment+" input:checked").val()),e(o.choose_payment+" input").change(function(){e(o.payment_method_selector+" .error").remove()}),"undefined"!=typeof Payment&&"ach"!==i){var a=Payment.fns.cardExpiryVal(e(o.cc_exp_selector,t).val()),l=Payment.fns.validateCardNumber(e(o.cc_num_selector,t).val()),c=Payment.fns.validateCardExpiry(a.month,a.year),p=Payment.fns.validateCardCVC(e(o.cc_cvv_selector,t).val(),o.cardType);!1===l||!1===c||!1===p?(s=!1,!1===l?(e(o.cc_num_selector).after('<p class="card-instruction invalid cc-error">Your credit card number is not valid. Please try again.</p>'),e(o.cc_num_selector,t).addClass("error"),e(o.cc_num_selector,t).parent().addClass("error")):(e(o.cc_exp_selector,t).removeClass("error"),e(o.cc_cvv_selector,t).removeClass("error"),e(o.cc_exp_selector,t).parent().removeClass("error"),e(o.cc_cvv_selector,t).parent().removeClass("error")),!1===c?(e(o.cc_exp_selector).after('<p class="card-instruction invalid cc-error">Your credit card expiration date is not valid. Please try again.</p>'),e(o.cc_exp_selector,t).addClass("error"),e(o.cc_exp_selector,t).parent().addClass("error")):(e(o.cc_num_selector,t).removeClass("error"),e(o.cc_cvv_selector,t).removeClass("error"),e(o.cc_num_selector,t).parent().removeClass("error"),e(o.cc_cvv_selector,t).parent().removeClass("error")),!1===p?(e(o.cc_cvv_selector).after('<p class="card-instruction invalid cc-error">Your credit card CVC number is not valid. Please try again.</p>'),e(o.cc_cvv_selector,t).addClass("error"),e(o.cc_cvv_selector,t).parent().addClass("error")):(e(o.cc_num_selector,t).removeClass("error"),e(o.cc_exp_selector,t).removeClass("error"),e(o.cc_num_selector,t).parent().removeClass("error"),e(o.cc_exp_selector,t).parent().removeClass("error"))):(e(o.cc_num_selector,t).parent().removeClass("error"),e(o.cc_num_selector,t).removeClass("error"),e(o.cc_exp_selector,t).parent().removeClass("error"),e(o.cc_exp_selector,t).removeClass("error"),e(o.cc_cvv_selector,t).parent().removeClass("error"),e(o.cc_cvv_selector,t).removeClass("error"))}else"ach"===i&&0===e('input[name="bankToken"]').length&&(s=!1,e(o.payment_method_selector).prepend('<p class="error">You are required to enter credit card information, or to authorize MinnPost to charge your bank account, to make a payment.</p>'));var d=e(o.donate_form_selector);if(!0===s){r.buttonStatus(o,d.find("button"),!0);var u=function(n,s){r.debug("trying to get stripe response");var i=e(o.donate_form_selector);if(s.errors)r.buttonStatus(o,i.find("button"),!1);else{if(0===e('input[name="bankToken"]').length){var a=s.id;e('input[name="stripeToken"]').length>0?e('input[name="stripeToken"]').val(a):i.append(e('<input type="hidden" name="stripeToken" />').val(a)),e('input[name="payment_type"]').length>0?e('input[name="payment_type"]').val(s.card.brand):i.append(e('<input type="hidden" name="payment_type" />').val(s.card.brand))}else e('input[name="payment_type"]').length>0?e('input[name="payment_type"]').val("ach"):i.append(e('<input type="hidden" name="payment_type" />').val("ach"));e.ajax({url:"/charge_ajax/",cache:!1,data:e(i).serialize(),type:"POST"}).done(function(n){if(void 0!==n.errors){if(r.buttonStatus(o,i.find("button"),!1),e.each(n.errors,function(n,r){var s=r.field+"_field_selector",i="";i="string"==typeof r.message?r.message:r.message[0],e(s).length>0&&(e(o[s],t).addClass("error"),e(o[s],t).prev().addClass("error"),e(o[s],t).after('<span class="check-field invalid">'+i+"</span>")),"csrf_token"==r.field&&e("button.give").before('<p class="error">Sorry, this form had a back-end error and was unable to complete your donation. Please <a href="#" onclick="location.reload(); return false;">reload the page</a> and try again (we will preserve as much of your information as possible).</p>')}),void 0!==n.errors.error&&("invalid_number"!=n.errors.error.code&&"incorrect_number"!=n.errors.error.code&&"card_declined"!=n.errors.error.code&&"processing_error"!=n.errors.error.code||(e(o.cc_num_selector,t).addClass("error"),e(o.cc_num_selector,t).prev().addClass("error"),e(o.cc_num_selector,t).after('<span class="card-instruction invalid">'+n.errors.error.message+"</span>")),"invalid_expiry_month"!=n.errors.error.code&&"invalid_expiry_year"!=n.errors.error.code&&"expired_card"!=n.errors.error.code||(e(o.cc_exp_selector,t).addClass("error"),e(o.cc_exp_selector,t).prev().addClass("error"),e(o.cc_num_selector,t).after('<span class="card-instruction invalid">'+n.errors.error.message+"</span>")),"invalid_cvc"!=n.errors.error.code&&"incorrect_cvc"!=n.errors.error.code||(e(o.cc_cvv_selector,t).addClass("error"),e(o.cc_cvv_selector,t).prev().addClass("error"),e(o.cc_num_selector,t).after('<span class="card-instruction invalid">'+n.errors.error.message+"</span>")),"invalid_request_error"==n.errors.error.type&&e("button.give").before('<p class="error">'+n.errors.error.message+"</p>")),void 0!==n.errors[0]){var s=n.errors[0].field+"_field_selector";e(s).length>0&&e("html, body").animate({scrollTop:e(o[s],t).parent().offset().top},2e3)}}else i.get(0).submit()}).error(function(e){r.buttonStatus(o,i.find("button"),!1)}),r.buttonStatus(o,i.find("button"),!0)}},_="";_=e("#full_name").length>0?e("#full_name").val():e("#first_name").val()+" "+e("#last_name").val();var h="None";""!=e('input[name="full_address"]').val()&&(h=e("#full_address").val(),""!=e('input[name="billing_street"]').val()&&(h=e('input[name="billing_street"]').val()));var m="None";""!=e('input[name="billing_city"]').val()&&(m=e('input[name="billing_city"]').val());var f="None";""!=e('input[name="billing_state"]').val()&&(f=e('input[name="billing_state"]').val());var v="None";""!=e('input[name="billing_zip"]').val()&&(v=e('input[name="billing_zip"]').val());var g="US";if(""!=e('input[name="billing_country"]').val()&&(g=e('input[name="billing_country"]').val()),!0===o.create_account){var y={email:e(o.email_field_selector,t).val(),first:e(o.first_name_field_selector,t).val(),last:e(o.last_name_field_selector,t).val(),password:e(o.password_field_selector,t).val(),city:e(o.account_city_selector,t).val(),state:e(o.account_state_selector,t).val(),zip:e(o.account_zip_selector,t).val()};e.ajax({method:"POST",url:o.minnpost_root+"/accounts/create",data:y}).done(function(e){"success"===e.status&&e.reason})}if(0==e('input[name="bankToken"]').length)Stripe.card.createToken({number:e(o.cc_num_selector).val(),cvc:e(o.cc_cvv_selector).val(),exp:e(o.cc_exp_selector).val(),name:_,address_line1:h,address_city:m,address_state:f,address_zip:v,address_country:g},u);else u(0,e("#bankToken").val())}else r.buttonStatus(o,d.find("button"),!1)})},showNewsletterSettings:function(t,n){if(e(n.newsletter_group_selector).length>0&&void 0!==e(n.email_field_selector,t).val()){var o={email:e(n.email_field_selector,t).val()};e.ajax({method:"GET",url:n.minnpost_root+"/wp-json/minnpost-api/v1/mailchimp/user",data:o}).done(function(o){if(void 0!==o.status&&e(n.email_field_selector,t).after('<input name="mailchimp_user_status" type="hidden" value="'+o.status+'">'),void 0!==o.mailchimp_id&&e(n.email_field_selector,t).after('<input name="mailchimp_user_id" type="hidden" value="'+o.mailchimp_id+'">'),"subscribed"===o.status){e(".confirm-instructions").text(e(".confirm-instructions").attr("data-known-user"));var r=o.interests;e.each(r,function(t,n){!0===n?e(':checkbox[value="'+t+'"]').prop("checked",!0):e(':checkbox[value="'+t+'"]').prop("checked",!1)})}})}},confirmMessageSubmit:function(t,n){var o=e(".support-newsletter :input").serialize();e(n.confirm_form_selector).submit(function(r){r.preventDefault();e(n.confirm_form_selector);var s=e(n.newsletter_group_selector+":checked"),i=e(n.message_group_selector+":checked"),a=e(".support-newsletter :input:checked").serialize();if(o!==a&&(void 0!==s||void 0!==i)){var l={email:e(n.email_field_selector,t).val(),first_name:e(n.first_name_field_selector,t).val(),last_name:e(n.last_name_field_selector,t).val(),newsletters:{},occasional_emails:{}};e('input[name="mailchimp_user_status"]').length>0&&(l.mailchimp_user_status=e('input[name="mailchimp_user_status"]').val()),e('input[name="mailchimp_user_id"]').length>0&&(l.mailchimp_user_id=e('input[name="mailchimp_user_id"]').val()),void 0!==s&&e.each(s,function(t,n){var o=e(this).val();l.newsletters[t]=o}),void 0!==i&&e.each(i,function(t,n){var o=e(this).val();l.occasional_emails[t]=o}),e.ajax({url:n.minnpost_root+"/wp-json/minnpost-api/v1/mailchimp/user",type:"post",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(l)}).done(function(e){console.dir(e);e.success}).fail(function(e){})}})}},e.fn[s]=function(t){return this.each(function(){e.data(this,"plugin_"+s)||e.data(this,"plugin_"+s,new r(this,t))})}}(jQuery,window,document);