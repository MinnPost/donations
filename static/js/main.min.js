!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;((t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).payment||(t.payment={})).js=e()}}(function(){return function s(i,a,l){function c(n,e){if(!a[n]){if(!i[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(p)return p(n,!0);var o=new Error("Cannot find module '"+n+"'");throw o.code="MODULE_NOT_FOUND",o}var r=a[n]={exports:{}};i[n][0].call(r.exports,function(e){var t=i[n][1][e];return c(t||e)},r,r.exports,s,i,a,l)}return a[n].exports}for(var p="function"==typeof require&&require,e=0;e<l.length;e++)c(l[e]);return c}({1:[function(e,t,n){var d,o,r;(d=function(e){return d.isDOMElement(e)?e:document.querySelectorAll(e)}).isDOMElement=function(e){return e&&null!=e.nodeName},r=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,d.trim=function(e){return null===e?"":(e+"").replace(r,"")},o=/\r/g,d.val=function(e,t){var n;return 1<arguments.length?e.value=t:"string"==typeof(n=e.value)?n.replace(o,""):null===n?"":n},d.preventDefault=function(e){if("function"!=typeof e.preventDefault)return e.returnValue=!1;e.preventDefault()},d.normalizeEvent=function(e){var t;return null==(e={which:null!=(t=e).which?t.which:void 0,target:t.target||t.srcElement,preventDefault:function(){return d.preventDefault(t)},originalEvent:t,data:t.data||t.detail}).which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e},d.on=function(e,t,n){var o,r,s,i,a,l,c,p;if(e.length)for(r=0,i=e.length;r<i;r++)o=e[r],d.on(o,t,n);else{if(!t.match(" "))return c=n,n=function(e){return e=d.normalizeEvent(e),c(e)},e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?(t="on"+t,e.attachEvent(t,n)):void(e["on"+t]=n);for(s=0,a=(p=t.split(" ")).length;s<a;s++)l=p[s],d.on(e,l,n)}},d.addClass=function(o,r){var s;return o.length?function(){var e,t,n;for(n=[],e=0,t=o.length;e<t;e++)s=o[e],n.push(d.addClass(s,r));return n}():o.classList?o.classList.add(r):o.className+=" "+r},d.hasClass=function(e,t){var n,o,r,s;if(e.length){for(o=!0,r=0,s=e.length;r<s;r++)n=e[r],o=o&&d.hasClass(n,t);return o}return e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className)},d.removeClass=function(o,r){var e,s,t,n,i,a;if(o.length)return function(){var e,t,n;for(n=[],e=0,t=o.length;e<t;e++)s=o[e],n.push(d.removeClass(s,r));return n}();if(o.classList){for(a=[],t=0,n=(i=r.split(" ")).length;t<n;t++)e=i[t],a.push(o.classList.remove(e));return a}return o.className=o.className.replace(new RegExp("(^|\\b)"+r.split(" ").join("|")+"(\\b|$)","gi")," ")},d.toggleClass=function(o,r,s){var i;return o.length?function(){var e,t,n;for(n=[],e=0,t=o.length;e<t;e++)i=o[e],n.push(d.toggleClass(i,r,s));return n}():s?d.hasClass(o,r)?void 0:d.addClass(o,r):d.removeClass(o,r)},d.append=function(o,r){var s;return o.length?function(){var e,t,n;for(n=[],e=0,t=o.length;e<t;e++)s=o[e],n.push(d.append(s,r));return n}():o.insertAdjacentHTML("beforeend",r)},d.find=function(e,t){return(e instanceof NodeList||e instanceof Array)&&(e=e[0]),e.querySelectorAll(t)},d.trigger=function(e,t,n){var o;try{o=new CustomEvent(t,{detail:n})}catch(e){e,(o=document.createEvent("CustomEvent")).initCustomEvent?o.initCustomEvent(t,!0,!0,n):o.initEvent(t,!0,!0,n)}return e.dispatchEvent(o)},t.exports=d},{}],2:[function(P,A,e){(function(e){var i,l,c,r,a,t,n,s,p,d,u,_,h,m,f,v,g,y,w,o,b,x,C,k,S=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};l=P("qj/src/qj.coffee"),a=[{type:"amex",pattern:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[4],luhn:!0},{type:"dankort",pattern:/^5019/,format:t=/(\d{1,4})/g,length:[16],cvcLength:[3],luhn:!0},{type:"dinersclub",pattern:/^(36|38|30[0-5])/,format:t,length:[14],cvcLength:[3],luhn:!0},{type:"discover",pattern:/^(6011|65|64[4-9]|622)/,format:t,length:[16],cvcLength:[3],luhn:!0},{type:"jcb",pattern:/^35/,format:t,length:[16],cvcLength:[3],luhn:!0},{type:"laser",pattern:/^(6706|6771|6709)/,format:t,length:[16,17,18,19],cvcLength:[3],luhn:!0},{type:"maestro",pattern:/^(5018|5020|5038|6304|6703|6759|676[1-3])/,format:t,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"mastercard",pattern:/^5[1-5]/,format:t,length:[16],cvcLength:[3],luhn:!0},{type:"unionpay",pattern:/^62/,format:t,length:[16,17,18,19],cvcLength:[3],luhn:!1},{type:"visaelectron",pattern:/^4(026|17500|405|508|844|91[37])/,format:t,length:[16],cvcLength:[3],luhn:!0},{type:"visa",pattern:/^4/,format:t,length:[13,16],cvcLength:[3],luhn:!0},{type:"elo",pattern:/^4011|438935|45(1416|76)|50(4175|6699|67|90[4-7])|63(6297|6368)/,format:t,length:[16],cvcLength:[3],luhn:!0}],c=function(e){var t,n,o;for(e=(e+"").replace(/\D/g,""),n=0,o=a.length;n<o;n++)if((t=a[n]).pattern.test(e))return t},r=function(e){var t,n,o;for(n=0,o=a.length;n<o;n++)if((t=a[n]).type===e)return t},f=function(e){var t,n,o,r,s,i;for(s=!0,o=i=0,r=(n=(e+"").split("").reverse()).length;o<r;o++)t=n[o],t=parseInt(t,10),(s=!s)&&(t*=2),9<t&&(t-=9),i+=t;return i%10==0},m=function(e){var t;return null!=e.selectionStart&&e.selectionStart!==e.selectionEnd||!(null==("undefined"!=typeof document&&null!==document&&null!=(t=document.selection)?t.createRange:void 0)||!document.selection.createRange().text)},v=function(n){return setTimeout(function(){var e,t;return e=n.target,t=l.val(e),t=i.fns.formatCardNumber(t),l.val(e,t)})},p=function(e){var t,n,o,r,s,i,a;if(n=String.fromCharCode(e.which),/^\d+$/.test(n)&&(s=e.target,a=l.val(s),t=c(a+n),o=(a.replace(/\D/g,"")+n).length,i=16,t&&(i=t.length[t.length.length-1]),!(i<=o||null!=s.selectionStart&&s.selectionStart!==a.length)))return(r=t&&"amex"===t.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/).test(a)?(e.preventDefault(),l.val(s,a+" "+n)):r.test(a+n)?(e.preventDefault(),l.val(s,a+n+" ")):void 0},n=function(e){var t,n;if(t=e.target,n=l.val(t),!e.meta&&8===e.which&&(null==t.selectionStart||t.selectionStart===n.length))return/\d\s$/.test(n)?(e.preventDefault(),l.val(t,n.replace(/\d\s$/,""))):/\s\d?$/.test(n)?(e.preventDefault(),l.val(t,n.replace(/\s\d?$/,""))):void 0},d=function(e){var t,n,o;if(t=String.fromCharCode(e.which),/^\d+$/.test(t))return n=e.target,o=l.val(n)+t,/^\d$/.test(o)&&"0"!==o&&"1"!==o?(e.preventDefault(),l.val(n,"0"+o+" / ")):/^\d\d$/.test(o)?(e.preventDefault(),l.val(n,o+" / ")):void 0},h=function(e){var t,n,o;if(t=String.fromCharCode(e.which),/^\d+$/.test(t))return n=e.target,o=l.val(n)+t,/^\d$/.test(o)&&"0"!==o&&"1"!==o?(e.preventDefault(),l.val(n,"0"+o)):/^\d\d$/.test(o)?(e.preventDefault(),l.val(n,""+o)):void 0},u=function(e){var t,n,o;if(t=String.fromCharCode(e.which),/^\d+$/.test(t))return n=e.target,o=l.val(n),/^\d\d$/.test(o)?l.val(n,o+" / "):void 0},_=function(e){var t,n;if("/"===String.fromCharCode(e.which))return t=e.target,n=l.val(t),/^\d$/.test(n)&&"0"!==n?l.val(t,"0"+n+" / "):void 0},s=function(e){var t,n;if(!e.metaKey&&(t=e.target,n=l.val(t),8===e.which&&(null==t.selectionStart||t.selectionStart===n.length)))return/\d(\s|\/)+$/.test(n)?(e.preventDefault(),l.val(t,n.replace(/\d(\s|\/)*$/,""))):/\s\/\s?\d?$/.test(n)?(e.preventDefault(),l.val(t,n.replace(/\s\/\s?\d?$/,""))):void 0},x=function(e){var t;return!(!e.metaKey&&!e.ctrlKey)||(32===e.which?e.preventDefault():0===e.which||(e.which<33||(t=String.fromCharCode(e.which),/[\d\s]/.test(t)?void 0:e.preventDefault())))},y=function(e){var t,n,o,r;if(o=e.target,n=String.fromCharCode(e.which),/^\d+$/.test(n)&&!m(o))if(r=(l.val(o)+n).replace(/\D/g,""),t=c(r)){if(!(r.length<=t.length[t.length.length-1]))return e.preventDefault()}else if(!(r.length<=16))return e.preventDefault()},o=function(e,t){var n,o;if(o=e.target,n=String.fromCharCode(e.which),/^\d+$/.test(n)&&!m(o))return(l.val(o)+n).replace(/\D/g,"").length>t?e.preventDefault():void 0},w=function(e){return o(e,6)},b=function(e){return o(e,2)},C=function(e){return o(e,4)},g=function(e){var t,n;if(n=e.target,t=String.fromCharCode(e.which),/^\d+$/.test(t)&&!m(n))return(l.val(n)+t).length<=4?void 0:e.preventDefault()},k=function(e){var t,o,n,r,s;if(r=e.target,s=l.val(r),n=i.fns.cardType(s)||"unknown",!l.hasClass(r,n))return t=function(){var e,t,n;for(n=[],e=0,t=a.length;e<t;e++)o=a[e],n.push(o.type);return n}(),l.removeClass(r,"unknown"),l.removeClass(r,t.join(" ")),l.addClass(r,n),l.toggleClass(r,"identified","unknown"!==n),l.trigger(r,"payment.cardType",n)},i=function(){function o(){}return o.fns={cardExpiryVal:function(e){var t,n,o;return t=(n=(e=e.replace(/\s/g,"")).split("/",2))[0],2===(null!=(o=n[1])?o.length:void 0)&&/^\d+$/.test(o)&&(o=(new Date).getFullYear().toString().slice(0,2)+o),{month:t=parseInt(t,10),year:o=parseInt(o,10)}},validateCardNumber:function(e){var t,n;return e=(e+"").replace(/\s+|-/g,""),!!/^\d+$/.test(e)&&(!!(t=c(e))&&(n=e.length,0<=S.call(t.length,n)&&(!1===t.luhn||f(e))))},validateCardExpiry:function(e,t){var n,o,r;return"object"==typeof e&&"month"in e&&(e=(r=e).month,t=r.year),!(!e||!t)&&(e=l.trim(e),t=l.trim(t),!!/^\d+$/.test(e)&&(!!/^\d+$/.test(t)&&(parseInt(e,10)<=12&&(2===t.length&&(t=(new Date).getFullYear().toString().slice(0,2)+t),o=new Date(t,e),n=new Date,o.setMonth(o.getMonth()-1),o.setMonth(o.getMonth()+1,1),n<o))))},validateCardCVC:function(e,t){var n,o;return e=l.trim(e),!!/^\d+$/.test(e)&&(t&&r(t)?(n=e.length,0<=S.call(null!=(o=r(t))?o.cvcLength:void 0,n)):3<=e.length&&e.length<=4)},cardType:function(e){var t;return e&&(null!=(t=c(e))?t.type:void 0)||null},formatCardNumber:function(e){var t,n,o,r;return(t=c(e))?(r=t.length[t.length.length-1],e=(e=e.replace(/\D/g,"")).slice(0,+r+1||9e9),t.format.global?null!=(o=e.match(t.format))?o.join(" "):void 0:(null!=(n=t.format.exec(e))&&n.shift(),null!=n?n.join(" "):void 0)):e}},o.restrictNumeric=function(e){return l.on(e,"keypress",x)},o.cardExpiryVal=function(e){return o.fns.cardExpiryVal(l.val(e))},o.formatCardCVC=function(e){return o.restrictNumeric(e),l.on(e,"keypress",g),e},o.formatCardExpiry=function(e){var t,n;return o.restrictNumeric(e),e.length&&2===e.length?(t=e[0],n=e[1],this.formatCardExpiryMultiple(t,n)):(l.on(e,"keypress",w),l.on(e,"keypress",d),l.on(e,"keypress",_),l.on(e,"keypress",u),l.on(e,"keydown",s)),e},o.formatCardExpiryMultiple=function(e,t){return l.on(e,"keypress",b),l.on(e,"keypress",h),l.on(t,"keypress",C)},o.formatCardNumber=function(e){return o.restrictNumeric(e),l.on(e,"keypress",y),l.on(e,"keypress",p),l.on(e,"keydown",n),l.on(e,"keyup",k),l.on(e,"paste",v),e},o.getCardArray=function(){return a},o.setCardArray=function(e){return a=e,!0},o.addToCardArray=function(e){return a.push(e)},o.removeFromCardArray=function(e){var t;for(t in a)a[t].type===e&&a.splice(t,1);return!0},o}(),A.exports=i,e.Payment=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"qj/src/qj.coffee":1}]},{},[2])(2)}),function(y,a,l,e){var n="minnpost_giving",o={debug:!1,tabs:!0,stripe_publishable_key:"",plaid_env:"",plaid_public_key:"",plaid_link:"#authorize-ach",minnpost_root:"https://www.minnpost.com",donate_form_selector:"#donate",review_step_selector:"#panel--review",details_step_selector:"#panel--details",attendees_step_selector:"#panel--attendees",donate_step_selector:"#panel--pay",confirm_form_selector:"#confirm",confirm_step_selector:"#panel--confirmation",active:"panel--review",confirm:"panel--confirmation",query:"step",percentage:.022,fixed_amount:.3,amex_percentage:.035,ach_percentage:.008,pay_cc_processing_selector:'input[id="edit-pay-fees"]',level_amount_selector:"#panel--review .amount .level-amount",original_amount_selector:"#amount",frequency_selector:".frequency",full_amount_selector:".full-amount",level_indicator_selector:"h2.level",level_name_selector:".level-name",review_benefits_selector:".review-benefits",allow_upsell:!0,upsell_btn_selector:".btn--upsell",upsell_selector:".well--upsell",upsell_amount_selector:".upsell-amount",swag_selector:".swag",separate_swag_selector:"fieldset.swag--separate",separate_swag_redeem:".swag-redeem--separate",swag_selector_choose_multiple:".swag--choose-multiple",swag_choose_multiple_name:"swag_thankyou",atlantic_status:'input[name="swag_atlanticsubscription"]',atlantic_existing:"#atlantic_existing",atlantic_selector:".form-item--atlantic_id",name_selector:".form-item--display-name",honor_selector:".honor",notify_selector:".notify_someone",notify_field_selector:".form-item--notify",anonymous_selector:"#edit-anonymous",show_billing_country_selector:"#billing_show_country",billing_country_selector:".form-item--country",show_shipping_country_selector:"#shipping_show_country",shipping_country_selector:".form-item--shipping-country",shipping_address_selector:".form-item--shipping-address",use_for_shipping_selector:"#useforshipping",email_field_selector:"#edit-email",password_field_selector:"#password",first_name_field_selector:"#first_name",last_name_field_selector:"#last_name",account_city_selector:"#billing_city",account_state_selector:"#billing_state",account_zip_selector:"#billing_zip",create_mp_selector:"#creatempaccount",password_selector:".form-item--password",calculated_amount_selector:".calculated-amount",quantity_field:"#quantity",quantity_selector:".quantity",item_selector:".purchase-item",single_unit_price_attribute:"unit-price",additional_amount_field:"#additional_donation",additional_amount_selector:".additional_donation",has_additional_text_selector:".has_additional",promo_selector:".form-item--promo-code",use_promocode_selector:"#use-promo-code",promocode_selector:"#promo_code",event_id_selector:"#event",calendar_button_selector:".addeventatc",billing_selector:"fieldset.billing",shipping_selector:"fieldset.shipping",credit_card_fieldset:".payment-method-group",choose_payment:"#choose-payment-method",payment_method_selector:".payment-method",cc_num_selector:"#cc-number",cc_exp_selector:"#cc-exp",cc_cvv_selector:"#cc-cvc",payment_button_selector:"#submit",confirm_button_selector:"#finish",opp_id_selector:"#flask_id",recurring_selector:"#recurring",newsletter_group_selector:'[name="newsletters"]',message_group_selector:'[name="messages"]',reason_field_selector:"#reason_for_supporting",share_reason_selector:"#reason_shareable",confirm_top_selector:".support--post-confirm",existing_newsletter_settings:"",levels:{1:{name:"bronze",max:60},2:{name:"silver",min:60,max:120},3:{name:"gold",min:120,max:240},4:{name:"platinum",min:240}},upsell:{bronze:!0,silver:9,gold:19,platinum:!1}};function t(e,t){this.element=e,this.options=y.extend({},o,t),this._defaults=o,this._name=n,this.init()}t.prototype={init:function(e,t){this.options.amount=!0!==e?parseFloat(y(this.options.level_amount_selector,this.element).text()):t,this.options.original_amount=parseInt(y(this.options.original_amount_selector,this.element).val(),10),this.options.frequency=parseFloat(y(this.options.frequency_selector,this.element).attr("data-year-freq"));var n=y(this.options.recurring_selector,this.element).val();void 0!==n&&(this.options.recurring=n.charAt(0).toUpperCase()+n.slice(1)),this.options.processing_percent=parseFloat(this.options.percentage),this.options.fixed_fee=parseFloat(this.options.fixed_amount),this.options.new_amount=(this.options.original_amount+this.options.fixed_fee)/(1-this.options.processing_percent),this.options.processing_fee=this.options.new_amount-this.options.original_amount,this.options.processing_fee=(Math.round(parseFloat(this.options.processing_fee)*Math.pow(10,2))/Math.pow(10,2)).toFixed(2),this.options.processing_fee_text=this.options.processing_fee,this.options.upsell_amount=parseFloat(y(this.options.upsell_amount_selector,this.element).text()),this.options.upsold=this.options.amount+this.options.upsell_amount,this.options.cardType=null,this.options.create_account=!1;var o=y("button.give, input.give").text();this.options.button_text=o,Stripe.setPublishableKey(this.options.stripe_publishable_key),""!==l.referrer&&y("#edit_url").prop("href",l.referrer),!0===this.options.debug&&this.debug(this.options);var r=this.qs[this.options.query];if(void 0===r&&(r=this.options.active),this.paymentPanels(r),0<y(this.options.pay_cc_processing_selector).length&&(this.creditCardProcessingFees(this.options,e),y(this.options.credit_card_fieldset).prepend('<input type="hidden" id="edit-pay-fees" name="pay_fees" value="0" />')),0<y(this.options.details_step_selector).length||0<y(this.options.review_step_selector).length){if(0<y(this.options.original_amount_selector).length){var s=this;y(this.options.original_amount_selector).change(function(){s.options.original_amount=y(s.options.original_amount_selector).val(),s.calculateFees("visa"),y(".add-credit-card-processing").text("Add $"+s.options.processing_fee_text),y("#edit-pay-fees").val(0)})}this.options.level=this.checkLevel(this.element,this.options,"name"),this.options.levelnum=this.checkLevel(this.element,this.options,"num"),this.honorOrMemory(this.element,this.options),this.swag(this.element,this.options,!1),this.upsell(this.element,this.options,this.options.amount,this.options.frequency)}0<y(this.options.donate_step_selector).length&&(this.donateAnonymously(this.element,this.options),this.outsideUnitedStates(this.element,this.options),this.shippingAddress(this.element,this.options),this.allowMinnpostAccount(this.element,this.options,!1),this.creditCardFields(this.element,this.options),this.achFields(this.element,this.options),this.validateAndSubmit(this.element,this.options)),0<y(this.options.calculated_amount_selector).length&&this.calculateAmount(this.element,this.options,""),0<y(this.options.use_promocode_selector).length&&this.usePromoCode(this.element,this.options),0<y(this.options.calendar_button_selector).length&&this.addToCalendar(this.element,this.options),0<y(this.options.confirm_step_selector).length&&(this.showNewsletterSettings(this.element,this.options),this.confirmMessageSubmit(this.element,this.options))},qs:function(e){if(""===e)return{};for(var t={},n=0;n<e.length;++n){var o=e[n].split("=",2);1===o.length?t[o[0]]="":t[o[0]]=decodeURIComponent(o[1].replace(/\+/g," "))}return t}(a.location.search.substr(1).split("&")),debug:function(e){!0===this.options.debug&&("object"!=typeof e?console.log(e):console.dir(e),console.dir(this))},getQueryStrings:function(e){if(void 0===e||""===e)return{};e=(e="?"+e.split("?")[1]).substr(1).split("&");for(var t={},n=0;n<e.length;++n){var o=e[n].split("=",2);1===o.length?t[o[0]]="":t[o[0]]=decodeURIComponent(o[1].replace(/\+/g," "))}return t},paymentPanels:function(e){var o=this,t=this.options.tabs,n="MinnPost | Support Us | ",r=y(".progress--donation li."+e).text(),s=(y(".progress--donation li."+e).next().text(),y(".progress--donation li."+e).index()+1),i=y(".progress--donation li").length;y(this.options.opp_id_selector).val();0<y(this.options.confirm_step_selector).length&&(e=this.options.confirm,y(".progress--donation li."+e+" span").addClass("active"),s=y(".progress--donation li."+e).index()+1,0<y(this.options.confirm_button_selector).length&&(i+=1)),s===i-1&&0<y(this.options.opp_id_selector).length?s="purchase":s===i&&0<y(this.options.opp_id_selector).length?s="purchase":s===i&&y(this.options.opp_id_selector).length,l.title=n+r,this.analyticsTrackingStep(s,n),!0===t?y(".panel").hide():y(".panel").show(),0===y(".progress--donation li .active").length?(y("#"+e).fadeIn(),y(".progress--donation li."+e+" a").addClass("active")):(e=y(".progress--donation li .active").parent().prop("class"),y("#"+e).fadeIn()),y(".progress--donation li a, a.btn.btn--next").click(function(e){e.preventDefault(),y(".progress--donation li a").removeClass("active");var t=y(this).prop("href"),n=o.getQueryStrings(t);n=n.step,y(".progress--donation li."+n+" a").addClass("active"),o.paymentPanels(n)})},analyticsTrackingStep:function(e,t){var n=this.checkLevel(this.element,this.options,"name"),o=(this.checkLevel(this.element,this.options,"num"),y(this.options.original_amount_selector).val()),r=this.options.recurring,s=y(this.options.opp_id_selector).val();ga("ec:addProduct",{id:"minnpost_"+n.toLowerCase()+"_membership",name:"MinnPost "+n.charAt(0).toUpperCase()+n.slice(1)+" Membership",category:"Donation",brand:"MinnPost",variant:r,price:o,quantity:1}),"purchase"===e?ga("ec:setAction","purchase",{id:s,affiliation:"MinnPost",revenue:o}):ga("ec:setAction","checkout",{step:e}),ga("set",{page:a.location.pathname,title:t}),ga("send","pageview",a.location.pathname)},calculateFees:function(e){this.options.fixed_fee=parseFloat(this.options.fixed_amount);var t=this.options.percentage,n=(this.options.fixed_amount,this.options.fixed_fee);"amex"===e?(t=this.options.amex_percentage,n=0):"ach"===e&&(t=this.options.ach_percentage,n=0),this.options.processing_percent=parseFloat(t),this.options.new_amount=(parseFloat(this.options.original_amount)+n)/(1-this.options.processing_percent),this.options.processing_fee=this.options.new_amount-this.options.original_amount,this.options.processing_fee=(Math.round(parseFloat(this.options.processing_fee)*Math.pow(10,2))/Math.pow(10,2)).toFixed(2),this.options.processing_fee_text=this.options.processing_fee},creditCardProcessingFees:function(t,e){var n,o=this,r=!1;y(this.options.pay_cc_processing_selector).parent().html('<a href="#" class="add-credit-card-processing">Add $<span class="processing-amount"></span></a> <span class="processing-explain">to each transaction to cover MinnPost\'s credit card fees?</span>'),y(".processing-amount").text(t.processing_fee_text),this.options.original_amount!=this.options.amount&&(y(".add-credit-card-processing").text("Remove $"+t.processing_fee_text),y("#edit-pay-fees").val(1),r=!0,y(".processing-explain").hide()),!0===e&&(r=!1,n=o.options.original_amount,y(".add-credit-card-processing").text("Add $"+o.options.processing_fee_text),y("#edit-pay-fees").val(0),y(".processing-explain").show()),y(".add-credit-card-processing").click(function(e){y(".amount .level-amount").addClass("full-amount"),r?(r=!1,n=o.options.original_amount,y(".add-credit-card-processing").text("Add $"+t.processing_fee_text),y("#edit-pay-fees").val(0),y(".processing-explain").show()):(r=!0,n=o.options.new_amount,y(".add-credit-card-processing").text("Remove $"+t.processing_fee_text),y("#edit-pay-fees").val(1),y(".processing-explain").hide()),y(".add-credit-card-processing").toggleClass("remove"),y(t.full_amount_selector).text(parseFloat(n).toFixed(2)),e.stopPropagation(),e.preventDefault()})},donateAnonymously:function(e,t){y(t.anonymous_selector,e).is(":checked")?y(t.name_selector+" div:first",e).hide():y(t.name_selector+" div:first",e).show(),y(t.anonymous_selector,e).change(function(){y(this).is(":checked")?y(t.name_selector+" div:first",e).hide():y(t.name_selector+" div:first",e).show()})},checkLevel:function(e,t,n){var i,a="",l=0,c="level level--",o=t.frequency,r=t.original_amount;if(12===o?i=r*o:1===o&&(i=r),y.each(t.levels,function(e,t){var n=t.name,o=e,r=t.max,s=t.min;if(void 0!==s&&void 0!==r){if(s<=i&&i<r)return a=n,c+=l=o,!1}else if(void 0!==r){if(i<r)return a=n,c+=l=o,!1}else if(void 0!==s&&s<=i)return a=n,c+=l=o,!1}),0<y(t.level_indicator_selector).length&&0<y(t.review_benefits_selector).length){y(t.level_indicator_selector,e).prop("class",c),y(t.level_name_selector).text(a.charAt(0).toUpperCase()+a.slice(1));var s=this.getQueryStrings(y(t.review_benefits_selector,e).prop("href"));s=s.level;var p=y(t.review_benefits_selector,e).prop("href");p=p.replace(s,a),y(t.review_benefits_selector).prop("href",p)}return"name"===n?a:"num"===n?l:void 0},upsell:function(n,o,e,t){if(!0===o.allow_upsell){var r,s=this;12===t?r=e:1===t&&(r=e/t),y.each(o.upsell,function(e,t){e===o.level&&(!0!==t&&r<t||!1===t)&&y(o.upsell_selector,n).hide()}),y(o.upsell_btn_selector,n).click(function(e){var t=o.upsold;s.options.amount=t,y(o.level_amount_selector,n).text(t),y(o.full_amount_selector,n).text(t),y(o.original_amount_selector,n).val(t),y(this).remove(),e.stopPropagation(),e.preventDefault(),s.init(!0,t)})}else y(o.upsell_selector,n).hide()},honorOrMemory:function(t,e){y(e.honor_selector+" fieldset").prepend('<a href="#" class="close">Close</a>'),y(e.honor_selector+" p a",t).click(function(){var e=y(this).prop("class");return y("fieldset."+e,t).addClass("visible").show(),!1}),y(e.honor_selector+" fieldset a.close",t).click(function(){var e=y(this).parent().prop("class").substring(0,y(this).parent().prop("class").length-8);return y("fieldset."+e,t).removeClass("visible").hide(),!1}),y(l).keyup(function(e){27===e.keyCode&&y("fieldset.visible",t).removeClass("visible").hide()}),y(e.notify_selector,t).is(":checked")?y(e.notify_field_selector,t).show():y(e.notify_field_selector,t).hide(),y(e.notify_selector,t).change(function(){y(this).is(":checked")?y(e.notify_field_selector,t).show():y(e.notify_field_selector,t).hide()})},swag:function(t,n,e){var o=this,r=o.options.levelnum;!1===e&&(y(n.swag_selector,t).hide(),y(n.swag_selector,t).filter(function(e){return y(this).prop("class").slice(-1)<=r}).show(),y(n.separate_swag_redeem,t).click(function(e){return e.stopImmediatePropagation(),y(n.separate_swag_selector,t).toggle(),!1})),y(n.atlantic_existing,t).is(":checked")?y(n.atlantic_selector,t).show():y(n.atlantic_selector,t).hide(),y(n.atlantic_status,t).change(function(){o.swag(t,n,!0)});var s=y(n.swag_selector_choose_multiple,t).data("maximum-choose");y(n.swag_selector_choose_multiple,t).show(),y(n.swag_selector_choose_multiple,t).find("label, .swag").show();var i=y(n.swag_selector_choose_multiple+' input[name="'+n.swag_choose_multiple_name+'"]:checked').length;y("input",n.swag_selector_choose_multiple).change(function(){"checkbox"==y(this).prop("type")&&(i=y(n.swag_selector_choose_multiple+' input[name="'+n.swag_choose_multiple_name+'"]:checked').length,s===i?y("input:not(:checked)",n.swag_selector_choose_multiple).attr("disabled",!0):y("input:not(:checked)",n.swag_selector_choose_multiple).attr("disabled",!1))})},outsideUnitedStates:function(e,t){y(t.show_billing_country_selector).click(function(){return y(t.billing_country_selector).show(),y(this).parent().hide(),!1}),y(t.show_shipping_country_selector).click(function(){return y(t.shipping_country_selector).show(),y(this).parent().hide(),!1})},shippingAddress:function(e,t){var n=this,o=!1;0<y(t.use_for_shipping_selector).length&&(o=!0),!0===o&&(y(t.use_for_shipping_selector,e).parent().show(),y(t.use_for_shipping_selector,e).is(":checked")?y(t.shipping_selector).hide():y(t.shipping_selector).show(),y(t.use_for_shipping_selector,e).change(function(){n.shippingAddress(e,t)}))},allowMinnpostAccount:function(t,n,e){var o,r=this;function s(){var e=y(n.email_field_selector,t).val();r.checkMinnpostAccountExists(t,n,e)}y(n.email_field_selector,t).keyup(function(){clearTimeout(o),y(n.email_field_selector,t).val&&(o=setTimeout(s,5e3))}),y(n.create_mp_selector,t).is(":checked")?(y(n.password_selector,t).show(),n.create_account=!0):y(n.password_selector,t).hide(),y(n.create_mp_selector,t).change(function(){r.allowMinnpostAccount(t,n,!0)}),!1===e&&(y(n.password_selector,t).append('<div class="help-link"><span>Password help</span></div><div class="form-help">Password must be at least 6 characters.</div><label class="additional-option"><input type="checkbox" name="showpassword" id="showpassword"> Show password</label>'),y(n.create_mp_selector,t).parent().before('<p class="account-exists success">There is already a MinnPost.com account with this email.</p>'),y(".account-exists").hide(),y("#showpassword").click(function(){y(this).is(":checked")?y("#password").get(0).type="text":y("#password").get(0).type="password"}),y(".form-item .form-help").hide()),y(".form-item--with-help label, .form-item--with-help input").next(".help-link").click(function(){return y(this).next(".form-help").toggle(),!1})},populateAttendees:function(e){var t="",n=y(".attendees > fieldset:first").html();for(i=1;i<=e;i++)t+='<fieldset class="attendee">'+n.replace(/_1/g,"_"+i)+"</fieldset>";y(".attendees").html(t)},displayAmount:function(e,t,n,o,r,s){var i=n*parseInt(o,10);""===r?(r=0,y(t.create_mp_selector).parent().hide()):(i+=parseInt(r,10),levelcheck={original_amount:r,frequency:1,levels:t.levels},level=this.checkLevel(e,levelcheck,"num"),2<=level&&y(t.create_mp_selector).parent().show(),y(t.has_additional_text_selector).html(y(t.has_additional_text_selector).data("text")),y(t.additional_amount_selector).text(parseFloat(y(t.additional_amount_field).val()))),y(t.calculated_amount_selector).text(i),y(t.original_amount_selector).val(o*n),y(t.quantity_selector).text(o),1==o?y(".attendee-title").text(y(".attendee-title").data("single")):y(".attendee-title").text(y(".attendee-title").data("plural")),y(".code-result").remove(),!0===s?(y(".apply-promo-code").after('<p class="code-result success">Your member discount code was successfully added.</p>'),y(".show-"+t.single_unit_price_attribute).text(n),y(".apply-promo-code").text("Applied").addClass("btn--disabled")):!1===s&&y(".apply-promo-code").after('<p class="code-result error">This code is incorrect. Try again.</p>')},calculateAmount:function(r,s,e){var i=this,t=y(s.quantity_field).val(),n=y(s.quantity_field).data(s.single_unit_price_attribute),o=y(s.additional_amount_field).val();!0===e.success&&(n=e.single_unit_price),i.displayAmount(r,s,n,t,o,e.success),y(s.quantity_field+", "+s.additional_amount_field).change(function(){t=y(s.quantity_field).val(),o=y(s.additional_amount_field).val(),1!=t?y(s.item_selector).text(y(s.item_selector).data("plural")):y(s.item_selector).text(y(s.item_selector).data("single")),i.displayAmount(r,s,n,t,o)});y(s.review_step_selector).find(".btn").click(function(){i.populateAttendees(t)}),y(".progress--donation .panel--attendees").find("a").click(function(){i.populateAttendees(t)}),0<y(this.options.promocode_selector).length&&y(".apply-promo-code").click(function(e){var t=y(s.promocode_selector,r).val();if(0<y(s.event_id_selector).length)var n=y(s.event_id_selector,r).val();else n=1;e.preventDefault();var o={promo_code:t,event:n};y.ajax({method:"POST",url:"/event-check-promo/",data:o}).done(function(e){i.calculateAmount(r,s,e)})})},checkPromoCode:function(e){var t={promo_code:e};y.ajax({method:"POST",url:"/event-check-promo/",data:t}).done(function(e){return!0===e.success})},usePromoCode:function(t,n){y(this.options.use_promocode_selector).parent().html('<a href="#" class="use-promo-code">Use promo code</a>'),""===y(this.options.promocode_selector).val()?y(n.promo_selector+" div:first",t).hide():y(n.promo_selector+" div:last",t).hide(),y(".use-promo-code").click(function(e){y(n.promo_selector+" div:first",t).show(),y(n.promo_selector+" div:last",t).hide(),e.preventDefault()})},addToCalendar:function(e,t){y(t.calendar_button_selector).css("display","inline-block")},checkMinnpostAccountExists:function(t,n,e){var o={email:e};y.ajax({method:"GET",url:n.minnpost_root+"/wp-json/user-account-management/v1/check-account-exists",data:o}).done(function(e){if("success"!==e.status||"user exists"!==e.reason)return y(n.create_mp_selector,t).is(":checked")?(y(n.password_selector,t).show(),n.create_account=!0):y(n.password_selector,t).hide(),y(".account-exists",t).hide(),!1;y(n.create_mp_selector,t).is(":checked")&&(y(n.password_selector,t).hide(),y(n.create_mp_selector,t).parent().hide(),y(".account-exists",t).show()),y(n.create_mp_selector,t).on("change",function(){y(n.create_mp_selector,t).is(":checked")&&(y(n.password_selector,t).hide(),y(n.create_mp_selector,t).parent().hide(),y(".account-exists",t).show())})})},creditCardFields:function(e,t){var n=this;if(0<y(t.choose_payment).length){if(y(t.choose_payment+" input").is(":checked")){var o=y(t.choose_payment+" input:checked").attr("id");y(t.payment_method_selector).removeClass("active"),y(t.payment_method_selector+"."+o).addClass("active"),y(t.payment_method_selector+":not(.active) label").removeClass("required"),y(t.payment_method_selector+":not(.active) input").prop("required",!1),y(t.payment_method_selector+".active label").addClass("required"),y(t.payment_method_selector+".active input").prop("required",!0)}y(t.choose_payment+" input").change(function(e){y(t.payment_method_selector).removeClass("active"),y(t.payment_method_selector+"."+this.id).addClass("active"),y(t.payment_method_selector+":not(.active) label").removeClass("required"),y(t.payment_method_selector+":not(.active) input").prop("required",!1),y(t.payment_method_selector+".active label").addClass("required"),y(t.payment_method_selector+".active input").prop("required",!0),y("#bankToken").remove()})}"undefined"!=typeof Payment&&(Payment.formatCardNumber(y(t.cc_num_selector,e)),Payment.formatCardExpiry(y(t.cc_exp_selector,e)),Payment.formatCardCVC(y(t.cc_cvv_selector,e)),y(t.cc_num_selector,e).parent().prepend('<span class="card-image"></span>'),y(t.cc_num_selector,e).keyup(function(){t.cardType=Payment.fns.cardType(y(t.cc_num_selector,e).val()),null!==t.cardType&&n.calculateFees(t.cardType),y(".add-credit-card-processing").text("Add $"+n.options.processing_fee_text),y("#edit-pay-fees").val(0),y(".card-image").prop("class","card-image "+y("#cc-number").prop("class"))}))},achFields:function(o,r){var s=this;if(""!=r.plaid_env&&""!=r.key&&"undefined"!=typeof Plaid){var t=Plaid.create({selectAccount:!0,apiVersion:"v2",env:r.plaid_env,clientName:"MinnPost",key:r.plaid_public_key,product:"auth",onLoad:function(){},onSuccess:function(e,t){var n=y(r.donate_form_selector);n.append(y('<input type="hidden" name="public_token" />').val(e)),n.append(y('<input type="hidden" name="account_id" />').val(t.account_id)),y.ajax({url:"/plaid_token/",data:y(n).serialize(),type:"POST"}).done(function(e){void 0!==e.error?y(r.plaid_link).parent().after('<p class="error">'+e.error+"</p>"):(y(r.donate_form_selector).prepend('<input type="hidden" id="bankToken" name="bankToken" value="'+e.stripe_bank_account_token+'" />'),y(r.plaid_link,o).html("<strong>Your account was successfully authorized</strong>").contents().unwrap(),s.calculateFees("ach"),y(".add-credit-card-processing").text("Add $"+s.options.processing_fee_text),y("#edit-pay-fees").val(0))}).error(function(e){y(r.plaid_link).parent().after('<p class="error">'+e.error+"</p>")})},onExit:function(e,t){}});y(r.plaid_link,o).click(function(e){e.preventDefault(),y(r.payment_method_selector+" .error").remove(),t.open()})}},hasHtml5Validation:function(e,t){return"function"==typeof l.createElement("input").checkValidity},buttonStatus:function(e,t,n){t.prop("disabled",n),!1===n?t.text(e.button_text):t.text("Processing")},validateAndSubmit:function(f,v){var g=this;y(this.options.donate_form_selector).prepend('<input type="hidden" id="source" name="source" value="'+l.referrer+'" />'),y(v.donate_form_selector).submit(function(e){e.preventDefault(),g.hasHtml5Validation(f,v)&&(this.checkValidity()?(y(this).removeClass("invalid"),y(this).find("input:invalid").parent().removeClass("error")):(y(this).addClass("invalid"),y("html, body").animate({scrollTop:y(this).find("input:invalid").parent().offset().top},2e3),y(this).find("input:invalid").parent().addClass("error"))),y(".check-field, .card-instruction").remove(),y("input, label",f).removeClass("error");var t=!0,n="card";if(0<y(v.choose_payment).length&&(n=y(v.choose_payment+" input:checked").val()),y(v.choose_payment+" input").change(function(){y(v.payment_method_selector+" .error").remove()}),"undefined"!=typeof Payment&&"ach"!==n){var o=Payment.fns.cardExpiryVal(y(v.cc_exp_selector,f).val()),r=Payment.fns.validateCardNumber(y(v.cc_num_selector,f).val()),s=Payment.fns.validateCardExpiry(o.month,o.year),i=Payment.fns.validateCardCVC(y(v.cc_cvv_selector,f).val(),v.cardType);!1===r||!1===s||!1===i?((t=!1)===r?(y(v.cc_num_selector).after('<p class="card-instruction invalid cc-error">Your credit card number is not valid. Please try again.</p>'),y(v.cc_num_selector,f).addClass("error"),y(v.cc_num_selector,f).parent().addClass("error")):(y(v.cc_exp_selector,f).removeClass("error"),y(v.cc_cvv_selector,f).removeClass("error"),y(v.cc_exp_selector,f).parent().removeClass("error"),y(v.cc_cvv_selector,f).parent().removeClass("error")),!1===s?(y(v.cc_exp_selector).after('<p class="card-instruction invalid cc-error">Your credit card expiration date is not valid. Please try again.</p>'),y(v.cc_exp_selector,f).addClass("error"),y(v.cc_exp_selector,f).parent().addClass("error")):(y(v.cc_num_selector,f).removeClass("error"),y(v.cc_cvv_selector,f).removeClass("error"),y(v.cc_num_selector,f).parent().removeClass("error"),y(v.cc_cvv_selector,f).parent().removeClass("error")),!1===i?(y(v.cc_cvv_selector).after('<p class="card-instruction invalid cc-error">Your credit card CVC number is not valid. Please try again.</p>'),y(v.cc_cvv_selector,f).addClass("error"),y(v.cc_cvv_selector,f).parent().addClass("error")):(y(v.cc_num_selector,f).removeClass("error"),y(v.cc_exp_selector,f).removeClass("error"),y(v.cc_num_selector,f).parent().removeClass("error"),y(v.cc_exp_selector,f).parent().removeClass("error"))):(y(v.cc_num_selector,f).parent().removeClass("error"),y(v.cc_num_selector,f).removeClass("error"),y(v.cc_exp_selector,f).parent().removeClass("error"),y(v.cc_exp_selector,f).removeClass("error"),y(v.cc_cvv_selector,f).parent().removeClass("error"),y(v.cc_cvv_selector,f).removeClass("error"))}else"ach"===n&&0===y('input[name="bankToken"]').length&&(t=!1,y(v.payment_method_selector).prepend('<p class="error">You are required to enter credit card information, or to authorize MinnPost to charge your bank account, to make a payment.</p>'));var a=y(v.donate_form_selector);if(!0===t){g.buttonStatus(v,a.find("button"),!0);var l=function(e,t){g.debug("trying to get stripe response");var n=y(v.donate_form_selector);if(t.errors)g.buttonStatus(v,n.find("button"),!1);else{if(0===y('input[name="bankToken"]').length){var o=t.id;0<y('input[name="stripeToken"]').length?y('input[name="stripeToken"]').val(o):n.append(y('<input type="hidden" name="stripeToken" />').val(o)),0<y('input[name="payment_type"]').length?y('input[name="payment_type"]').val(t.card.brand):n.append(y('<input type="hidden" name="payment_type" />').val(t.card.brand))}else 0<y('input[name="payment_type"]').length?y('input[name="payment_type"]').val("ach"):n.append(y('<input type="hidden" name="payment_type" />').val("ach"));y.ajax({url:"/charge_ajax/",cache:!1,data:y(n).serialize(),type:"POST"}).done(function(e){if(void 0!==e.errors){if(g.buttonStatus(v,n.find("button"),!1),y.each(e.errors,function(e,t){var n=t.field+"_field_selector",o="";o="string"==typeof t.message?t.message:t.message[0],0<y(n).length&&(y(v[n],f).addClass("error"),y(v[n],f).prev().addClass("error"),y(v[n],f).after('<span class="check-field invalid">'+o+"</span>")),"csrf_token"==t.field&&y("button.give").before('<p class="error">Sorry, this form had a back-end error and was unable to complete your donation. Please <a href="#" onclick="location.reload(); return false;">reload the page</a> and try again (we will preserve as much of your information as possible).</p>')}),void 0!==e.errors.error&&("invalid_number"!=e.errors.error.code&&"incorrect_number"!=e.errors.error.code&&"card_declined"!=e.errors.error.code&&"processing_error"!=e.errors.error.code||(y(v.cc_num_selector,f).addClass("error"),y(v.cc_num_selector,f).prev().addClass("error"),y(v.cc_num_selector,f).after('<span class="card-instruction invalid">'+e.errors.error.message+"</span>")),"invalid_expiry_month"!=e.errors.error.code&&"invalid_expiry_year"!=e.errors.error.code&&"expired_card"!=e.errors.error.code||(y(v.cc_exp_selector,f).addClass("error"),y(v.cc_exp_selector,f).prev().addClass("error"),y(v.cc_num_selector,f).after('<span class="card-instruction invalid">'+e.errors.error.message+"</span>")),"invalid_cvc"!=e.errors.error.code&&"incorrect_cvc"!=e.errors.error.code||(y(v.cc_cvv_selector,f).addClass("error"),y(v.cc_cvv_selector,f).prev().addClass("error"),y(v.cc_num_selector,f).after('<span class="card-instruction invalid">'+e.errors.error.message+"</span>")),"invalid_request_error"==e.errors.error.type&&y("button.give").before('<p class="error">'+e.errors.error.message+"</p>")),void 0!==e.errors[0]){var t=e.errors[0].field+"_field_selector";0<y(t).length&&y("html, body").animate({scrollTop:y(v[t],f).parent().offset().top},2e3)}}else n.get(0).submit()}).error(function(e){g.buttonStatus(v,n.find("button"),!1)}),g.buttonStatus(v,n.find("button"),!0)}},c="";c=0<y("#full_name").length?y("#full_name").val():y("#first_name").val()+" "+y("#last_name").val();var p="None";""!=y('input[name="full_address"]').val()&&(p=y("#full_address").val(),""!=y('input[name="billing_street"]').val()&&(p=y('input[name="billing_street"]').val()));var d="None";""!=y('input[name="billing_city"]').val()&&(d=y('input[name="billing_city"]').val());var u="None";""!=y('input[name="billing_state"]').val()&&(u=y('input[name="billing_state"]').val());var _="None";""!=y('input[name="billing_zip"]').val()&&(_=y('input[name="billing_zip"]').val());var h="US";if(""!=y('input[name="billing_country"]').val()&&(h=y('input[name="billing_country"]').val()),!0===v.create_account){var m={email:y(v.email_field_selector,f).val(),first_name:y(v.first_name_field_selector,f).val(),last_name:y(v.last_name_field_selector,f).val(),password:y(v.password_field_selector,f).val(),city:y(v.account_city_selector,f).val(),state:y(v.account_state_selector,f).val(),zip:y(v.account_zip_selector,f).val()};y.ajax({method:"POST",url:v.minnpost_root+"/wp-json/user-account-management/v1/create-user",data:m}).done(function(e){"success"===e.status&&e.reason})}if(0==y('input[name="bankToken"]').length)Stripe.card.createToken({number:y(v.cc_num_selector).val(),cvc:y(v.cc_cvv_selector).val(),exp:y(v.cc_exp_selector).val(),name:c,address_line1:p,address_city:d,address_state:u,address_zip:_,address_country:h},l);else l(0,y("#bankToken").val())}else g.buttonStatus(v,a.find("button"),!1)})},showNewsletterSettings:function(n,o){if(0<y(o.newsletter_group_selector).length&&void 0!==y(o.email_field_selector,n).val()){var e={email:y(o.email_field_selector,n).val()};y.ajax({method:"GET",url:o.minnpost_root+"/wp-json/minnpost-api/v2/mailchimp/user",data:e}).done(function(e){if(void 0!==e.status&&y(o.email_field_selector,n).after('<input name="mailchimp_status" type="hidden" value="'+e.status+'">'),void 0!==e.mailchimp_id&&y(o.email_field_selector,n).after('<input name="mailchimp_user_id" type="hidden" value="'+e.mailchimp_id+'">'),"subscribed"===e.status){y(".confirm-instructions").text(y(".confirm-instructions").attr("data-known-user"));var t=e.interests;y.each(t,function(e,t){!0===t?y(':checkbox[value="'+e+'"]').prop("checked",!0):y(':checkbox[value="'+e+'"]').prop("checked",!1)})}})}},confirmMessageSubmit:function(i,a){var l=y(".support-newsletter :input").serialize();y(a.confirm_form_selector).submit(function(e){e.preventDefault();var t=y(a.confirm_form_selector),n=y(a.newsletter_group_selector+":checked"),o=y(a.message_group_selector+":checked"),r=y(".support-newsletter :input:checked").serialize();if(l===r||void 0===n&&void 0===o)t.get(0).submit();else{var s={email:y(a.email_field_selector,i).val(),first_name:y(a.first_name_field_selector,i).val(),last_name:y(a.last_name_field_selector,i).val(),groups_submitted:{},groups_available:"all"};0<y('input[name="mailchimp_status"]').length&&(s.mailchimp_status=y('input[name="mailchimp_status"]').val()),0<y('input[name="mailchimp_user_id"]').length&&(s.mailchimp_user_id=y('input[name="mailchimp_user_id"]').val()),void 0!==n&&y.each(n,function(e,t){var n=y(this).val();s.groups_submitted[e]=n}),void 0!==o&&y.each(o,function(e,t){var n=y(this).val();s.groups_submitted[e]=n}),y.ajax({url:a.minnpost_root+"/wp-json/minnpost-api/v2/mailchimp/user",type:"post",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(s)}).done(function(e){e.success,t.get(0).submit()}).fail(function(e){t.get(0).submit()})}})}},y.fn[n]=function(e){return this.each(function(){y.data(this,"plugin_"+n)||y.data(this,"plugin_"+n,new t(this,e))})}}(jQuery,window,document);