!function(o){"use strict";function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function t(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function i(r){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?t(Object(a),!0).forEach(function(e){var t,n;t=r,e=a[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(a)):t(Object(a)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(a,e))})}return r}function u(e,t,n,r,a,o,i){try{var l=e[o](i),u=l.value}catch(e){return void n(e)}l.done?t(u):Promise.resolve(u).then(r,a)}function l(l){return function(){var e=this,i=arguments;return new Promise(function(t,n){var r=l.apply(e,i);function a(e){u(r,t,n,a,o,"next",e)}function o(e){u(r,t,n,a,o,"throw",e)}a(void 0)})}}!function(e){var t;"object"===("undefined"==typeof exports?"undefined":M(exports))&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):((t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).payment||(t.payment={})).js=e()}(function(){return function r(a,o,i){function l(n,e){if(!o[n]){if(!a[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(u)return u(n,!0);t=new Error("Cannot find module '"+n+"'");throw t.code="MODULE_NOT_FOUND",t}t=o[n]={exports:{}};a[n][0].call(t.exports,function(e){var t=a[n][1][e];return l(t||e)},t,t.exports,r,a,o,i)}return o[n].exports}for(var u="function"==typeof require&&require,e=0;e<i.length;e++)l(i[e]);return l}({1:[function(e,t,n){var r,a,f=function(e){return f.isDOMElement(e)?e:document.querySelectorAll(e)};f.isDOMElement=function(e){return e&&null!=e.nodeName},a=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,f.trim=function(e){return null===e?"":(e+"").replace(a,"")},r=/\r/g,f.val=function(e,t){return 1<arguments.length?e.value=t:"string"==typeof(e=e.value)?e.replace(r,""):null===e?"":e},f.preventDefault=function(e){if("function"!=typeof e.preventDefault)return e.returnValue=!1;e.preventDefault()},f.normalizeEvent=function(e){var t=e;return null==(e={which:null!=t.which?t.which:void 0,target:t.target||t.srcElement,preventDefault:function(){return f.preventDefault(t)},originalEvent:t,data:t.data||t.detail}).which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e},f.on=function(e,t,n){var r,a,o,i,l,u,s,c;if(e.length)for(a=0,i=e.length;a<i;a++)r=e[a],f.on(r,t,n);else{if(!t.match(" "))return s=n,n=function(e){return e=f.normalizeEvent(e),s(e)},e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent(t="on"+t,n):void(e["on"+t]=n);for(o=0,l=(c=t.split(" ")).length;o<l;o++)u=c[o],f.on(e,u,n)}},f.addClass=function(r,a){var o;return r.length?function(){for(var e=[],t=0,n=r.length;t<n;t++)o=r[t],e.push(f.addClass(o,a));return e}():r.classList?r.classList.add(a):r.className+=" "+a},f.hasClass=function(e,t){var n,r,a,o;if(e.length){for(r=!0,a=0,o=e.length;a<o;a++)n=e[a],r=r&&f.hasClass(n,t);return r}return e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className)},f.removeClass=function(r,a){var e,o,t,n,i,l;if(r.length)return function(){for(var e=[],t=0,n=r.length;t<n;t++)o=r[t],e.push(f.removeClass(o,a));return e}();if(r.classList){for(l=[],t=0,n=(i=a.split(" ")).length;t<n;t++)e=i[t],l.push(r.classList.remove(e));return l}return r.className=r.className.replace(new RegExp("(^|\\b)"+a.split(" ").join("|")+"(\\b|$)","gi")," ")},f.toggleClass=function(r,a,o){var i;return r.length?function(){for(var e=[],t=0,n=r.length;t<n;t++)i=r[t],e.push(f.toggleClass(i,a,o));return e}():o?f.hasClass(r,a)?void 0:f.addClass(r,a):f.removeClass(r,a)},f.append=function(r,a){var o;return r.length?function(){for(var e=[],t=0,n=r.length;t<n;t++)o=r[t],e.push(f.append(o,a));return e}():r.insertAdjacentHTML("beforeend",a)},f.find=function(e,t){return(e=e instanceof NodeList||e instanceof Array?e[0]:e).querySelectorAll(t)},f.trigger=function(e,t,n){var r;try{r=new CustomEvent(t,{detail:n})}catch(e){(r=document.createEvent("CustomEvent")).initCustomEvent?r.initCustomEvent(t,!0,!0,n):r.initEvent(t,!0,!0,n)}return e.dispatchEvent(r)},t.exports=f},{}],2:[function(O,S,e){!function(e){var a,l,u,r,o,t,n,i,s,c,f,d,v,p,h,g,m,y,w,C,E,b,x,D,L=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};function k(){}l=O("qj/src/qj.coffee"),o=[{type:"amex",pattern:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[4],luhn:!0},{type:"dankort",pattern:/^5019/,format:t=/(\d{1,4})/g,length:[16],cvcLength:[3],luhn:!0},{type:"dinersclub",pattern:/^(36|38|30[0-5])/,format:t,length:[14],cvcLength:[3],luhn:!0},{type:"discover",pattern:/^(6011|65|64[4-9]|622)/,format:t,length:[16],cvcLength:[3],luhn:!0},{type:"jcb",pattern:/^35/,format:t,length:[16],cvcLength:[3],luhn:!0},{type:"laser",pattern:/^(6706|6771|6709)/,format:t,length:[16,17,18,19],cvcLength:[3],luhn:!0},{type:"maestro",pattern:/^(5018|5020|5038|6304|6703|6759|676[1-3])/,format:t,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"mastercard",pattern:/^5[1-5]/,format:t,length:[16],cvcLength:[3],luhn:!0},{type:"unionpay",pattern:/^62/,format:t,length:[16,17,18,19],cvcLength:[3],luhn:!1},{type:"visaelectron",pattern:/^4(026|17500|405|508|844|91[37])/,format:t,length:[16],cvcLength:[3],luhn:!0},{type:"visa",pattern:/^4/,format:t,length:[13,16],cvcLength:[3],luhn:!0},{type:"elo",pattern:/^4011|438935|45(1416|76)|50(4175|6699|67|90[4-7])|63(6297|6368)/,format:t,length:[16],cvcLength:[3],luhn:!0}],u=function(e){var t,n,r;for(e=(e+"").replace(/\D/g,""),n=0,r=o.length;n<r;n++)if((t=o[n]).pattern.test(e))return t},r=function(e){for(var t,n=0,r=o.length;n<r;n++)if((t=o[n]).type===e)return t},h=function(e){for(var t,n=!0,r=0,a=(e+"").split("").reverse(),o=0,i=a.length;o<i;o++)t=a[o],t=parseInt(t,10),(n=!n)&&(t*=2),9<t&&(t-=9),r+=t;return r%10==0},p=function(e){var t;return null!=e.selectionStart&&e.selectionStart!==e.selectionEnd||!(null==("undefined"!=typeof document&&null!==document&&null!=(t=document.selection)?t.createRange:void 0)||!document.selection.createRange().text)},g=function(n){return setTimeout(function(){var e=n.target,t=l.val(e);return t=a.fns.formatCardNumber(t),l.val(e,t)})},s=function(e){var t,n,r,a,o,i=String.fromCharCode(e.which);if(/^\d+$/.test(i)&&(r=e.target,o=l.val(r),n=u(o+i),t=(o.replace(/\D/g,"")+i).length,a=16,!((a=n?n.length[n.length.length-1]:a)<=t||null!=r.selectionStart&&r.selectionStart!==o.length)))return(n=n&&"amex"===n.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/).test(o)?(e.preventDefault(),l.val(r,o+" "+i)):n.test(o+i)?(e.preventDefault(),l.val(r,o+i+" ")):void 0},n=function(e){var t=e.target,n=l.val(t);if(!e.meta&&8===e.which&&(null==t.selectionStart||t.selectionStart===n.length))return/\d\s$/.test(n)?(e.preventDefault(),l.val(t,n.replace(/\d\s$/,""))):/\s\d?$/.test(n)?(e.preventDefault(),l.val(t,n.replace(/\s\d?$/,""))):void 0},c=function(e){var t,n=String.fromCharCode(e.which);if(/^\d+$/.test(n))return t=e.target,n=l.val(t)+n,/^\d$/.test(n)&&"0"!==n&&"1"!==n?(e.preventDefault(),l.val(t,"0"+n+" / ")):/^\d\d$/.test(n)?(e.preventDefault(),l.val(t,n+" / ")):void 0},v=function(e){var t,n=String.fromCharCode(e.which);if(/^\d+$/.test(n))return t=e.target,n=l.val(t)+n,/^\d$/.test(n)&&"0"!==n&&"1"!==n?(e.preventDefault(),l.val(t,"0"+n)):/^\d\d$/.test(n)?(e.preventDefault(),l.val(t,""+n)):void 0},f=function(e){var t=String.fromCharCode(e.which);if(/^\d+$/.test(t))return t=e.target,e=l.val(t),/^\d\d$/.test(e)?l.val(t,e+" / "):void 0},d=function(e){var t;if("/"===String.fromCharCode(e.which))return t=e.target,e=l.val(t),/^\d$/.test(e)&&"0"!==e?l.val(t,"0"+e+" / "):void 0},i=function(e){var t,n;if(!e.metaKey&&(t=e.target,n=l.val(t),8===e.which&&(null==t.selectionStart||t.selectionStart===n.length)))return/\d(\s|\/)+$/.test(n)?(e.preventDefault(),l.val(t,n.replace(/\d(\s|\/)*$/,""))):/\s\/\s?\d?$/.test(n)?(e.preventDefault(),l.val(t,n.replace(/\s\/\s?\d?$/,""))):void 0},b=function(e){var t;return!(!e.metaKey&&!e.ctrlKey)||(32===e.which?e.preventDefault():0===e.which||(e.which<33||(t=String.fromCharCode(e.which),/[\d\s]/.test(t)?void 0:e.preventDefault())))},y=function(e){var t=e.target,n=String.fromCharCode(e.which);if(/^\d+$/.test(n)&&!p(t))if(t=(l.val(t)+n).replace(/\D/g,""),n=u(t)){if(!(t.length<=n.length[n.length.length-1]))return e.preventDefault()}else if(!(t.length<=16))return e.preventDefault()},C=function(e,t){var n=e.target,r=String.fromCharCode(e.which);if(/^\d+$/.test(r)&&!p(n))return(l.val(n)+r).replace(/\D/g,"").length>t?e.preventDefault():void 0},w=function(e){return C(e,6)},E=function(e){return C(e,2)},x=function(e){return C(e,4)},m=function(e){var t=e.target,n=String.fromCharCode(e.which);if(/^\d+$/.test(n)&&!p(t))return(l.val(t)+n).length<=4?void 0:e.preventDefault()},D=function(e){var r,t=e.target,n=l.val(t),e=a.fns.cardType(n)||"unknown";if(!l.hasClass(t,e))return n=function(){for(var e=[],t=0,n=o.length;t<n;t++)r=o[t],e.push(r.type);return e}(),l.removeClass(t,"unknown"),l.removeClass(t,n.join(" ")),l.addClass(t,e),l.toggleClass(t,"identified","unknown"!==e),l.trigger(t,"payment.cardType",e)},k.fns={cardExpiryVal:function(e){var t,e=(t=(e=e.replace(/\s/g,"")).split("/",2))[0];return 2===(null!=(t=t[1])?t.length:void 0)&&/^\d+$/.test(t)&&(t=(new Date).getFullYear().toString().slice(0,2)+t),{month:e=parseInt(e,10),year:t=parseInt(t,10)}},validateCardNumber:function(e){var t,n;return e=(e+"").replace(/\s+|-/g,""),!!/^\d+$/.test(e)&&(!!(t=u(e))&&(n=e.length,0<=L.call(t.length,n)&&(!1===t.luhn||h(e))))},validateCardExpiry:function(e,t){var n;return"object"===M(e)&&"month"in e&&(e=(n=e).month,t=n.year),!(!e||!t)&&(e=l.trim(e),t=l.trim(t),!!/^\d+$/.test(e)&&(!!/^\d+$/.test(t)&&(parseInt(e,10)<=12&&(2===t.length&&(t=(new Date).getFullYear().toString().slice(0,2)+t),t=new Date(t,e),e=new Date,t.setMonth(t.getMonth()-1),t.setMonth(t.getMonth()+1,1),e<t))))},validateCardCVC:function(e,t){var n;return e=l.trim(e),!!/^\d+$/.test(e)&&(t&&r(t)?(n=e.length,0<=L.call(null!=(t=r(t))?t.cvcLength:void 0,n)):3<=e.length&&e.length<=4)},cardType:function(e){return e&&(null!=(e=u(e))?e.type:void 0)||null},formatCardNumber:function(e){var t,n=u(e);return n?(t=n.length[n.length.length-1],e=(e=e.replace(/\D/g,"")).slice(0,+t+1||9e9),n.format.global?null!=(t=e.match(n.format))?t.join(" "):void 0:(null!=(n=n.format.exec(e))&&n.shift(),null!=n?n.join(" "):void 0)):e}},k.restrictNumeric=function(e){return l.on(e,"keypress",b)},k.cardExpiryVal=function(e){return k.fns.cardExpiryVal(l.val(e))},k.formatCardCVC=function(e){return k.restrictNumeric(e),l.on(e,"keypress",m),e},k.formatCardExpiry=function(e){var t,n;return k.restrictNumeric(e),e.length&&2===e.length?(t=e[0],n=e[1],this.formatCardExpiryMultiple(t,n)):(l.on(e,"keypress",w),l.on(e,"keypress",c),l.on(e,"keypress",d),l.on(e,"keypress",f),l.on(e,"keydown",i)),e},k.formatCardExpiryMultiple=function(e,t){return l.on(e,"keypress",E),l.on(e,"keypress",v),l.on(t,"keypress",x)},k.formatCardNumber=function(e){return k.restrictNumeric(e),l.on(e,"keypress",y),l.on(e,"keypress",s),l.on(e,"keydown",n),l.on(e,"keyup",D),l.on(e,"paste",g),e},k.getCardArray=function(){return o},k.setCardArray=function(e){return o=e,!0},k.addToCardArray=function(e){return o.push(e)},k.removeFromCardArray=function(e){for(var t in o)o[t].type===e&&o.splice(t,1);return!0},a=k,S.exports=a,e.Payment=a}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"qj/src/qj.coffee":1}]},{},[2])(2)}),function r(a,o,i){function l(t,e){if(!o[t]){if(!a[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(u)return u(t,!0);throw(n=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",n}n=o[t]={exports:{}},a[t][0].call(n.exports,function(e){return l(a[t][1][e]||e)},n,n.exports,r,a,o,i)}return o[t].exports}for(var u="function"==typeof require&&require,e=0;e<i.length;e++)l(i[e]);return l}({1:[function(e,t,n){var r,a=e("./src/valid-form"),e=(r=a)&&r.__esModule?r:{default:r};window.ValidForm=e.default,window.ValidForm.toggleInvalidClass=a.toggleInvalidClass,window.ValidForm.handleCustomMessages=a.handleCustomMessages,window.ValidForm.handleCustomMessageDisplay=a.handleCustomMessageDisplay},{"./src/valid-form":3}],2:[function(e,t,n){function r(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}Object.defineProperty(n,"__esModule",{value:!0}),n.clone=r,n.defaults=function(e,t){for(var n in e=r(e||{}),t)void 0===e[n]&&(e[n]=t[n]);return e},n.insertAfter=function(e,t){var n=e.nextSibling;n?e.parentNode.insertBefore(t,n):parent.appendChild(t)},n.insertBefore=function(e,t){e.parentNode.insertBefore(t,e)},n.forEach=function(e,t){if(e)if(e.forEach)e.forEach(t);else for(var n=0;n<e.length;n++)t(e[n],n,e)},n.debounce=function(e,t){var n=void 0;return function(){clearTimeout(n),n=setTimeout(t,e)}}},{}],3:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.toggleInvalidClass=a,n.handleCustomMessages=o,n.handleCustomMessageDisplay=u,n.default=function(e,t){if(!e||!e.nodeName)throw new Error("First arg to validForm must be a form, input, select, or textarea");var n=void 0,r=e.nodeName.toLowerCase();if(t=(0,l.defaults)(t,s),"form"===r)n=e.querySelectorAll("input, select, textarea"),function(t,e){var n=(0,l.debounce)(100,function(){var e=t.querySelector(":invalid");e&&e.focus()});(0,l.forEach)(e,function(e){return e.addEventListener("invalid",n)})}(e,n);else{if("input"!==r&&"select"!==r&&"textarea"!==r)throw new Error("Only form, input, select, or textarea elements are supported");n=[e]}!function(e,t){var n=t.invalidClass,r=t.customMessages;(0,l.forEach)(e,function(e){a(e,n),o(e,r),u(e,t)})}(n,t)};var l=e("./util");function a(e,t){e.addEventListener("invalid",function(){e.classList.add(t)}),e.addEventListener("input",function(){e.validity.valid&&e.classList.remove(t)})}var i=["badInput","patternMismatch","rangeOverflow","rangeUnderflow","stepMismatch","tooLong","tooShort","typeMismatch","valueMissing","customError"];function o(t,n){function e(){var e=t.validity.valid?null:function(e,t){t=t||{};for(var n=[e.type+"Mismatch"].concat(i),r=e.validity,a=0;a<n.length;a++){var o=n[a];if(r[o])return e.getAttribute("data-"+o)||t[o]}}(t,n);t.setCustomValidity(e||"")}t.addEventListener("input",e),t.addEventListener("invalid",e)}function u(r,e){var a=e.validationErrorClass,o=e.validationErrorParentClass,i=e.errorPlacement;function t(e){var t=e.insertError,n=r.parentNode,e=n.querySelector("."+a)||document.createElement("div");!r.validity.valid&&r.validationMessage?(e.className=a,e.textContent=r.validationMessage,t&&(("before"===i?(0,l.insertBefore):(0,l.insertAfter))(r,e),n.classList.add(o))):(n.classList.remove(o),e.remove())}r.addEventListener("input",function(){t({insertError:!1})}),r.addEventListener("invalid",function(e){e.preventDefault(),t({insertError:!0})})}var s={invalidClass:"invalid",validationErrorClass:"validation-error",validationErrorParentClass:"has-validation-error",customMessages:{},errorPlacement:"before"}},{"./util":2}]},{},[1]),document.addEventListener("DOMContentLoaded",function(e){});var s=o("#donate"),c=o("#authorize-ach");l(regeneratorRuntime.mark(function e(){var r,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r={clientName:"MinnPost",env:"sandbox",product:["auth"],token:document.getElementById("plaid_link_token").value,onSuccess:function(){var n=l(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c.html('<img src="https://www.minnpost.com/wp-admin/images/spinner.gif" srcset="https://www.minnpost.com/wp-admin/images/spinner.gif 1x, https://www.minnpost.com/wp-admin/images/spinner-2x.gif 2x,">'),e.next=3,fetch("/get_plaid_access_token/",{method:"POST",body:JSON.stringify({public_token:t,account_id:n.account_id}),headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){console.dir(e);var t="bankToken",n='input[name="'+t+'"]';0<o(n).length?o(n).val(e.stripe_bank_account_token):o(s).prepend(o('<input type="hidden" name="'+t+'">').val(e.stripe_bank_account_token)),null!==parent&&c.parent().html("<strong>Your account was successfully authorized</strong>")});case 3:case"end":return e.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}(),onExit:function(){var n=l(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t&&"INVALID_LINK_TOKEN"===t.error_code)return a.destroy(),e.t0=Plaid,e.t1=i,e.t2=i({},r),e.t3={},e.next=8,fetchLinkToken();e.next=12;break;case 8:e.t4=e.sent,e.t5={token:e.t4},e.t6=(0,e.t1)(e.t2,e.t3,e.t5),a=e.t0.create.call(e.t0,e.t6);case 12:case 13:case"end":return e.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}()},a=Plaid.create(r),document.getElementById("authorize-ach").onclick=function(e){e.preventDefault(),a.open()};case 3:case"end":return e.stop()}},e)}))()}(jQuery);